{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { nextTick } from 'vue';\nimport { Icon } from '@iconify/vue';\nimport EmojiPicker from 'vue3-emoji-picker';\nimport 'vue3-emoji-picker/css';\nimport CommentCard from '@/components/CommentCard.vue';\nimport Notify from '@/components/Notify.vue';\nimport ChatPanel from '@/components/ChatPanel.vue';\nimport story1 from '@/assets/mini.jpg';\nimport story2 from '@/assets/Khmer.jpg';\nimport story3 from '@/assets/sinayun_xyn.jpg';\nimport story4 from '@/assets/jena8.jpg';\nimport story5 from '@/assets/story2.jpg';\nimport sinayun from '@/assets/mini1.jpg';\nimport FriendSearch from '@/components/FriendSearch.vue';\nimport aesp from '@/assets/aesp.jpg';\nexport default {\n  name: '',\n  components: {\n    FriendSearch,\n    Notify,\n    Icon,\n    EmojiPicker,\n    CommentCard,\n    ChatPanel,\n    name: 'PostComposer'\n  },\n  data() {\n    return {\n      following: [],\n      // stores userIds you follow\n\n      showSearch: false,\n      searchQuery: '',\n      showResults: false,\n      postLink: null,\n      //Story\n      composerType: null,\n      // null | 'post' | 'story'\n      uploadedFiles: [],\n      currentUser: {\n        name: 'Sina Yun',\n        avatar: story4,\n        username: 'CurrentUser',\n        uid: null,\n        // Friend List for Share Post\n        friends: [{\n          id: 1,\n          name: 'Sokha',\n          avatar: story1\n        }, {\n          id: 2,\n          name: 'Dara',\n          avatar: story2\n        }, {\n          id: 3,\n          name: 'Sreyneang',\n          avatar: story3\n        }, {\n          id: 4,\n          name: 'Vannak',\n          avatar: story4\n        }, {\n          id: 5,\n          name: 'Rithy',\n          avatar: story5\n        }]\n      },\n      showLikes: false,\n      showNotify: false,\n      notifications: [],\n      media: [],\n      //store uplouad post\n      currentIndex: 0,\n      // for slide post \n      newPost: '',\n      showEmojiPickerIndex: false,\n      mediaPreviews: [],\n      activeStory: null,\n      currentStoryIndex: null,\n      autoCloseTimer: null,\n      activeMenuIndex: null,\n      editingIndex: null,\n      editedCaption: '',\n      storyScrollRef: null,\n      sharePopupRefs: [],\n      showShareModal: false,\n      activeSharedPostIndex: null,\n      showLocation: false,\n      postLocation: '',\n      replyCommentVisible: false,\n      touchStartX: 0,\n      touchEndX: 0,\n      selectedMedia: null,\n      selectedIndex: 0,\n      activePostMedia: [],\n      activePreview: null,\n      scrollContainer: null,\n      showLocationPopup: false,\n      locationInput: '',\n      suggestions: [{\n        name: 'Phnom Penh',\n        desc: 'Cambodia'\n      }, {\n        name: 'Siem Reap',\n        desc: 'Angkor Wat'\n      }, {\n        name: 'Kampot',\n        desc: 'Riverside town'\n      } //Location Limit\n      ],\n      locationInputRef: null,\n      tags: [],\n      showMentionList: false,\n      mentionQuery: '',\n      filteredUsers: [],\n      textareaRef: null,\n      users: [{\n        name: 'sinayun'\n      }, {\n        name: 'nayun'\n      }, {\n        name: 'nita_lovekhmer'\n      }, {\n        name: 'chakriya'\n      }, {\n        name: 'konkhmer'\n      }, {\n        id: 1,\n        username: 'sinayun',\n        avatar: sinayun\n      },\n      // Foller\n      {\n        id: 2,\n        username: 'nayun',\n        avatar: story2\n      }, {\n        id: 3,\n        username: 'nita_lovekhmer',\n        avatar: story3\n      }, {\n        id: 4,\n        username: 'chakriya',\n        avatar: story4\n      }, {\n        id: 5,\n        username: 'konkhmer',\n        avatar: story5\n      }, {\n        id: 'u_2',\n        username: 'nayun_ndo',\n        followers: ['u_1', 'u_4']\n      }],\n      showPostModal: false,\n      showChatPopup: false,\n      selectedUser: {},\n      suggestedFriends: [{\n        id: 1,\n        name: 'nita_lovekhmer',\n        time: '01:12 PM',\n        avatar: story1\n      }, {\n        id: 2,\n        name: 'នារី_lovekhmer',\n        time: '06:16 AM',\n        avatar: story2\n      }, {\n        id: 3,\n        name: 'ycn_lovekhm',\n        time: '01:12 PM',\n        avatar: story3\n      }, {\n        id: 4,\n        name: 'Konsreypov',\n        time: '1:12 PM',\n        avatar: story4\n      }, {\n        id: 5,\n        name: 'Kon_Khmer',\n        time: '1:12 PM',\n        avatar: story5\n      }],\n      showSettings: false,\n      showRepostPopup: null,\n      //FriendSearch\n\n      friends: [{\n        id: 1,\n        username: 'Sina yun ',\n        avatar: story1\n      }, {\n        id: 2,\n        username: 'Putyhy ',\n        avatar: story2\n      }, {\n        id: 3,\n        username: 'oun mean',\n        avatar: story3\n      }, {\n        id: 4,\n        username: 'Yun sina',\n        avatar: story4\n      }],\n      //Show repost \n      showSharePopup: null,\n      replyText: '',\n      // Story \n\n      stories: [{\n        id: 1,\n        username: 'nayun',\n        avatar: sinayun,\n        media: story1,\n        type: 'image',\n        time: '1h ago',\n        liked: false\n      }, {\n        id: 2,\n        username: 'user_2',\n        media: story2,\n        type: 'video',\n        time: '2h ago',\n        liked: false\n      }, {\n        id: 3,\n        username: 'user_3',\n        media: story3,\n        type: 'image',\n        time: '3h ago',\n        liked: false\n      }, {\n        id: 4,\n        username: 'user_4',\n        media: story4,\n        type: 'image',\n        time: '3h ago',\n        liked: false\n      }, {\n        id: 5,\n        username: 'user_5',\n        media: story5,\n        type: 'image',\n        time: '3h ago',\n        liked: false\n      }, {\n        id: 6,\n        username: 'user_6',\n        media: story5,\n        type: 'image',\n        time: '3h ago',\n        liked: false\n      }, {\n        id: 7,\n        username: 'user_1',\n        media: story1,\n        type: 'image',\n        time: '1h ago',\n        liked: false\n      }, {\n        id: 8,\n        username: 'Konsreypov',\n        media: story1,\n        type: 'image',\n        time: '1h ago',\n        liked: false\n      }],\n      suggestedUsers: [{\n        id: 1,\n        avatar: sinayun,\n        username: 'nita_lovekhmer'\n      }, {\n        id: 2,\n        avatar: story2,\n        username: 'នារី_lovekhmer'\n      }, {\n        id: 3,\n        avatar: story3,\n        username: 'Chakriya_konsreypov'\n      }, {\n        id: 4,\n        avatar: story4,\n        username: 'ycn_lovekhm'\n      }, {\n        id: 5,\n        avatar: story5,\n        username: 'Kon_Khmer'\n      }],\n      //Post\n      posts: [{\n        id: 1,\n        userId: 'u_2',\n        user: 'nayun_ndo',\n        avatar: aesp,\n        Caption: 'Exploring the beautiful landscapes of Cambodia! #Travel #Adventure',\n        media: [{\n          url: story5,\n          type: 'image'\n        }],\n        time: '1h ago',\n        likes: 0,\n        shares: 0,\n        liked: false,\n        isFollowing: false,\n        //Follow in post\n        showComments: false,\n        showShare: false,\n        newComment: '',\n        commentMedia: [],\n        commentsList: [],\n        commentsDisabled: false\n      }]\n    };\n  },\n  //Show Result Search \n\n  computed: {\n    filteredSearchUsers() {\n      if (!this.searchQuery) return [];\n      return this.users.filter(u => u.username.toLowerCase().includes(this.searchQuery.toLowerCase()));\n    }\n  },\n  //Method \n  methods: {\n    // Open Friend Profile from Chat Panel\n    openProfile(index) {\n      console.log('Open friend profile:', index);\n    },\n    // Improved async link detection\n    async handlePostInput() {\n      // Keep any existing mention logic\n      this.handleMentionInput?.();\n      const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n      const match = this.newPost.match(urlRegex);\n      if (match) {\n        const url = match[0].trim();\n\n        // Avoid re-processing the same URL\n        if (this.postLink?.url === url) return;\n\n        // Show loading state (optional, but nice UX)\n        this.postLink = {\n          url,\n          type: 'loading'\n        };\n        const enrichedLink = await this.detectLinkType(url);\n        this.postLink = enrichedLink;\n      } else {\n        this.postLink = null;\n      }\n    },\n    async detectLinkType(url) {\n      // Clean trailing punctuation\n      let cleanUrl = url.replace(/\\.,;!?]+$/, '');\n\n      // YouTube detection\n      if (cleanUrl.includes('youtube.com') || cleanUrl.includes('youtu.be')) {\n        return {\n          url: cleanUrl,\n          type: 'youtube'\n        };\n      }\n\n      // Use Microlink.io API — works without API key (free daily quota)\n      try {\n        const response = await fetch(`https://api.microlink.io/?url=${encodeURIComponent(cleanUrl)}`);\n        const data = await response.json();\n        if (data.data) {\n          const info = data.data;\n          return {\n            url: info.url || cleanUrl,\n            type: 'website',\n            title: info.title || null,\n            description: info.description || null,\n            image: info.image?.url || info.screenshot?.url || null,\n            // fallback to screenshot if no og:image\n            domain: new URL(info.url || cleanUrl).hostname.replace('www.', '')\n          };\n        }\n      } catch (err) {\n        console.log('Link preview failed:', err);\n      }\n\n      // Final fallback\n      try {\n        const domain = new URL(cleanUrl).hostname.replace('www.', '');\n        return {\n          url: cleanUrl,\n          type: 'website',\n          title: domain.charAt(0).toUpperCase() + domain.slice(1),\n          description: cleanUrl,\n          image: null,\n          domain\n        };\n      } catch {\n        return {\n          url: cleanUrl,\n          type: 'website',\n          title: 'Link',\n          description: '',\n          image: null,\n          domain: 'unknown'\n        };\n      }\n    },\n    //Story Add composer\n\n    //commment Uploaod Post\n\n    addCommentImage(event, index) {\n      const file = event.target.files[0];\n      if (!file) return;\n      const post = this.posts[index];\n      if (!post.commentMedia) {\n        this.$set ? this.$set(post, 'commentMedia', []) : post.commentMedia = [];\n      }\n      post.commentMedia.push({\n        url: URL.createObjectURL(file),\n        type: file.type\n      });\n      event.target.value = '';\n    },\n    getYouTubeId(url) {\n      const regExp = /^.*((youtu.be\\/)|(v\\/)|(u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#&?]*).*/;\n      const match = url.match(regExp);\n      return match && match[7].length === 11 ? match[7] : null;\n    },\n    handleCommentMediaUpload(event, index) {\n      const files = Array.from(event.target.files);\n      const post = this.posts[index];\n\n      // SAFETY\n      if (!post.commentMedia) {\n        this.$set(post, 'commentMedia', []);\n      }\n      files.forEach(file => {\n        post.commentMedia.push({\n          url: URL.createObjectURL(file),\n          type: file.type.startsWith('video') ? 'video' : 'image'\n        });\n      });\n      event.target.value = '';\n    },\n    //Link post \n    //Youtube\n\n    //toglle User \n\n    toggleFollowUser(userId) {\n      if (userId === this.currentUser.id) return;\n      const user = this.users.find(u => u.id === userId);\n      if (!user) return;\n      user.followers ||= [];\n      const i = this.following.indexOf(userId);\n      if (i === -1) {\n        this.following.push(userId);\n        user.followers.push(this.currentUser.id);\n      } else {\n        this.following.splice(i, 1);\n        user.followers = user.followers.filter(id => id !== this.currentUser.id);\n      }\n    },\n    //Comment\n    toggleMenu(index) {\n      this.activeMenuIndex = this.activeMenuIndex === index ? null : index;\n    },\n    //Follow in post\n    toggleFollow(index) {\n      const post = this.posts[index];\n\n      // prevent following yourself \n      if (post.user === this.currentUser.name) return;\n      post.isFollowing = !post.isFollowing;\n    },\n    toggleSearch() {\n      this.showSearch = !this.showSearch;\n    },\n    closeIfEmpty() {\n      if (!this.searchQuery) {\n        this.showSearch = false;\n      }\n    },\n    handleSearch() {\n      console.log('Search:', this.searchQuery);\n    },\n    onSearchFocus() {\n      this.showResults = true;\n    },\n    selectSearchUser(user) {\n      this.searchQuery = '';\n      this.showResults = false;\n      this.showSearch = false;\n\n      // go to user profile\n      this.$router.push(`/profile/${user.username}`);\n    },\n    //Heart Notify\n    listenRealtime() {\n      // Example: real-time push\n      setInterval(() => {\n        const newNotification = {\n          id: Date.now(),\n          userId: 3,\n          username: \"new_user\",\n          action: \"Love your post\",\n          time: new Date().toLocaleTimeString(),\n          avatar: \"\" // friend Lisdt here \n        };\n        this.notifications.unshift(newNotification);\n      }, 5000);\n    },\n    //Notify popup\n    openLikesPopup() {\n      console.log(\"Heart clicked\");\n      this.showLikes = true;\n    },\n    goToMainfeed() {\n      window.location.reload();\n    },\n    goToProfileUser() {\n      this.$router.push('/profile'); //Go to Profile\n    },\n    goLogin() {\n      localStorage.clear();\n      sessionStorage.clear();\n      this.$router.push('/'); //Go to Profile\n    },\n    handleTouchStart(e) {\n      this.touchStartX = e.changedTouches[0].screenX;\n    },\n    handleTouchEnd(e) {\n      this.touchEndX = e.changedTouches[0].screenX;\n      this.handleSwipe();\n    },\n    handleSwipe() {\n      const distance = this.touchEndX - this.touchStartX;\n      if (distance > 50) this.prevMedia();\n      if (distance < -50) this.nextMedia();\n    },\n    openMediaModal(media, mediaList) {\n      this.activePostMedia = mediaList;\n      this.selectedIndex = mediaList.findIndex(m => m.url === media.url);\n      this.selectedMedia = this.activePostMedia[this.selectedIndex];\n    },\n    closeMediaModal() {\n      this.selectedMedia = null;\n      this.selectedIndex = 0;\n      this.activePostMedia = [];\n    },\n    nextMedia() {\n      if (this.selectedIndex < this.activePostMedia.length - 1) {\n        this.selectedIndex++;\n        this.selectedMedia = this.activePostMedia[this.selectedIndex];\n      }\n    },\n    prevMedia() {\n      if (this.selectedIndex > 0) {\n        this.selectedIndex--;\n        this.selectedMedia = this.activePostMedia[this.selectedIndex];\n      }\n    },\n    handleKeydown(e) {\n      if (!this.selectedMedia) return;\n      if (e.key === 'ArrowRight') this.nextMedia();\n      if (e.key === 'ArrowLeft') this.prevMedia();\n      if (e.key === 'Escape') this.closeMediaModal();\n    },\n    openPreview(media) {\n      this.activePreview = media;\n    },\n    closePreview() {\n      this.activePreview = null;\n    },\n    removeMedia(index) {\n      this.mediaPreviews.splice(index, 1);\n    },\n    //Remove Comment\n    removeCommentMedia(postIndex, mediaIndex) {\n      const post = this.posts[postIndex];\n      if (post.commentMedia && post.commentMedia[mediaIndex]) {\n        URL.revokeObjectURL(post.commentMedia[mediaIndex].url);\n        post.commentMedia.splice(mediaIndex, 1);\n      }\n    },\n    handleFileUpload(e) {\n      const files = Array.from(e.target.files);\n\n      // map files to preview objects\n      const newFiles = files.map(file => ({\n        url: URL.createObjectURL(file),\n        type: file.type,\n        // e.g., \"image/jpeg\" or \"video/mp4\"\n        raw: file,\n        name: file.name,\n        size: file.size\n      }));\n\n      // append to mediaPreviews\n      this.mediaPreviews.push(...newFiles);\n    },\n    removeFile(index) {\n      URL.revokeObjectURL(this.mediaPreviews[index].url);\n      this.mediaPreviews.splice(index, 1);\n    },\n    handleDrop(e) {\n      const files = Array.from(e.dataTransfer.files);\n      this.mediaPreviews = files.map(file => ({\n        url: URL.createObjectURL(file),\n        type: file.type\n      }));\n    },\n    //Emoji Post \n    togglePostEmojiPicker() {\n      this.showPostEmojiPicker = !this.showPostEmojiPicker;\n    },\n    EmojiToPost(emoji) {\n      this.newPost += emoji.i;\n      this.showPostEmojiPicker = false;\n    },\n    toggleEmojiPicker(index) {\n      this.showEmojiPickerIndex = this.showEmojiPickerIndex === index ? null : index;\n      this.showEmojiPickerIndex === index ? null : index;\n    },\n    //add Emoji commet\n    addEmojiToComment(emoji, index) {\n      this.showEmojiPickerIndex === index ? null : index;\n      if (!this.posts[index].newComment) {\n        this.posts[index].newComment = '';\n      }\n      this.posts[index].newComment += emoji.i;\n      this.showEmojiPickerIndex = null;\n    },\n    // Submit Post \n    submitPost() {\n      //Story Commposer \n      if (!this.newPost.trim() && this.mediaPreviews.length === 0 && !this.postLink) {\n        alert('Please add text or media before submitting.');\n        return;\n      }\n      if (this.composerType === 'story') {\n        // STORY ONLY \n        this.stories.unshift({\n          id: Date.now(),\n          username: this.currentUser.username,\n          avatar: this.currentUser.avatar,\n          media: this.mediaPreviews[0]?.url || '',\n          type: this.mediaPreviews[0]?.type.startsWith('video') ? 'video' : 'image',\n          time: 'Just now',\n          liked: false\n        });\n        this.$nextTick(() => {\n          const container = this.$refs.storyScrollRef;\n          if (container) container.scrollLeft = 0;\n        });\n\n        // Reset everything\n        this.resetComposer();\n        return; // ← VERY IMPORTANT: Stop here, don't create a post!\n      }\n\n      // REGULAR POST ONLY \n      const linkCopy = this.postLink ? {\n        ...this.postLink\n      } : null;\n      const newPostObj = {\n        id: Date.now(),\n        user: this.currentUser.name,\n        avatar: this.currentUser.avatar,\n        location: this.postLocation.trim(),\n        caption: this.newPost,\n        media: this.mediaPreviews.map(preview => ({\n          url: preview.url,\n          type: preview.type\n        })),\n        link: linkCopy,\n        time: 'Just now',\n        likes: 0,\n        shares: 0,\n        liked: false,\n        isFollowing: false,\n        showComments: false,\n        newComment: '',\n        commentMedia: [],\n        commentsList: [],\n        commentsDisabled: false,\n        viewAll: false\n      };\n      this.posts.unshift(newPostObj);\n\n      // Reset\n      this.resetComposer();\n    },\n    resetComposer() {\n      this.newPost = '';\n      this.postLocation = '';\n      this.postLink = null;\n      this.composerType = null;\n      this.showPostModal = false;\n    },\n    countTotalComments(comments) {\n      let count = 0;\n      for (const comment of comments) {\n        count++;\n        if (comment.replies?.length) {\n          count += this.countTotalComments(comment.replies);\n        }\n      }\n      return count;\n    },\n    // Toggle Like \n    toggleLike(index) {\n      const post = this.posts[index];\n      post.liked = !post.liked;\n      post.likes += post.liked ? 1 : -1;\n\n      //story like Heart\n      if (!this.activeStory) return;\n      // Toggle active story\n      this.activeStory.liked = !this.activeStory.liked;\n\n      // Optional update the main stories array to persist\n      this.stories[this.currentStoryIndex].liked = this.activeStory.liked;\n    },\n    toggleSharePopup(index) {\n      this.posts[index].showShare = !this.posts[index].showShare;\n    },\n    addCommentToPost(index) {\n      const post = this.posts[index];\n      const text = post.newComment.trim();\n      if (!text) return;\n      if (!Array.isArray(post.commentsList)) post.commentsList = [];\n      if (!Array.isArray(post.commentMedia)) post.commentMedia = [];\n      post.commentsList.push({\n        user: this.currentUser.name,\n        avatar: this.currentUser.avatar || this.defaultAvatar,\n        text,\n        media: [...post.commentMedia],\n        time: 'Just now',\n        liked: false,\n        replies: []\n      });\n      post.newComment = '';\n      post.commentMedia = []; //Preview imgae\n    },\n    autoResize(event) {\n      const el = event.target;\n      el.style.height = 'auto';\n      el.style.height = el.scrollHeight + 'px';\n    },\n    //Location\n    getLocation() {\n      this.showLocationPopup = true;\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(pos => {\n          const {\n            latitude,\n            longitude\n          } = pos.coords;\n          fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`).then(res => res.json()).then(data => {\n            this.locationInput = data.address.city || data.address.town || data.address.village || 'Unknown';\n          }).catch(err => {\n            this.locationInput = 'Location error';\n            console.error(err);\n          });\n        }, error => {\n          console.error('Geolocation error:', error.message);\n          this.locationInput = 'Permission denied';\n        });\n      } else {\n        this.locationInput = 'Geolocation not supported';\n      }\n    },\n    confirmLocation() {\n      this.postLocation = this.locationInput;\n      this.showLocationPopup = false;\n      this.locationInput = '';\n    },\n    closeLocation() {\n      this.showLocationPopup = false;\n    },\n    pickSuggestion(s) {\n      this.locationInput = s.name;\n      this.confirmLocation();\n    },\n    formatCount(num) {\n      if (num >= 1000000000) return (num / 1000000000).toFixed(1) + 'B';\n      if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';\n      if (num >= 1000) return (num / 1000).toFixed(1) + 'K';\n      return num.toString();\n    },\n    updateCommentCount() {\n      console.log('Reply added!');\n    },\n    toggleCommentSection(index) {\n      this.posts[index].showComments = !this.posts[index].showComments;\n\n      // close menu if open\n      this.activeMenuIndex = null;\n    },\n    toggleComment(index) {\n      this.posts[index].commentsDisabled = !this.posts[index].commentsDisabled;\n      this.activeMenuIndex = null; // close menu\n    },\n    confirmDelete(index) {\n      this.posts.splice(index, 1);\n      this.activeMenuIndex = null;\n    },\n    startEditPost(index) {\n      this.editingIndex = index;\n      this.editedCaption = this.posts[index].caption;\n      this.activeMenuIndex = null;\n    },\n    saveEditedPost(index) {\n      this.posts[index].caption = this.editedCaption;\n      this.editingIndex = null;\n    },\n    cancelEdit() {\n      this.editingIndex = null;\n    },\n    // Scrolling Story Next icon \n    scrollStories(direction) {\n      const el = this.$refs.storyScrollRef;\n      if (!el) return;\n      const scrollAmount = 120; // width of one story card\n\n      if (direction === 'left') {\n        el.scrollBy({\n          left: -scrollAmount,\n          behavior: 'smooth'\n        });\n      } else {\n        el.scrollBy({\n          left: scrollAmount,\n          behavior: 'smooth'\n        });\n      }\n    },\n    //Story  Disable arrows at edges \n    canScrollLeft() {\n      const el = this.$refs.storyScrollRef;\n      return el && el.scrollLeft > 0;\n    },\n    canScrollRight() {\n      const el = this.$refs.storyScrollRef;\n      return el && el.scrollLeft + el.clientWidth < el.scrollWidth;\n    },\n    //Story open\n    openStory(index) {\n      this.currentStoryIndex = index;\n      this.activeStory = this.stories[index];\n      this.activeStory = this.stories[index];\n      this.progress = 0; // reset progress\n    },\n    //Story close\n    closeStory() {\n      this.activeStory = null;\n      clearTimeout(this.autoCloseTimer);\n      this.progress = 0;\n    },\n    //Story next\n    nextStory() {\n      if (this.currentStoryIndex < this.stories.length - 1) {\n        this.openStory(this.currentStoryIndex + 1);\n      } else {\n        this.closeStory();\n      }\n    },\n    //Story pre\n    prevStory() {\n      if (this.currentStoryIndex > 0) {\n        this.openStory(this.currentStoryIndex - 1);\n      }\n    },\n    //Sotry\n    sendReply() {\n      const text = this.replyText.trim();\n      if (!text) return;\n      this.replyText = '';\n    },\n    copyLink() {\n      navigator.clipboard.writeText(window.location.href).then(() => {\n        alert('Link copied to ');\n      });\n    },\n    shareToFacebook() {\n      const url = encodeURIComponent(window.location.href);\n      const fbUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;\n      window.open(fbUrl, '_blank', 'width=600,height=600');\n    },\n    shareToTelegram() {\n      const url = encodeURIComponent(window.location.href);\n      const tgUrl = `https://t.me/share/url?url=${url}`;\n      window.open(tgUrl, '_blank', 'width=600,height=600');\n    },\n    shareToMessenger() {\n      const url = encodeURIComponent(window.location.href);\n      const appId = 'FACEBOOK_APP_ID';\n      const msgUrl = `https://www.messenger.com/dialog/send?link=${url}&app_id=${appId}&redirect_uri=${url}`;\n      window.open(msgUrl, '_blank', 'width=600,height=600');\n    },\n    // Outside Click\n    handleClickOutside(event) {\n      const wrapper = this.$refs.emojiWrapper;\n      if (wrapper && !wrapper.contains(event.target)) {\n        this.showEmojiPickerIndex = false;\n      }\n    },\n    handleOutsideClick(event) {\n      // Close Emoji Picker\n      const emojiPickers = this.$refs.emojiPickerRefs || [];\n      if (!emojiPickers.some(ref => ref.contains(event.target))) {\n        this.showEmojiPickerIndex = false;\n      }\n\n      // Close Post Menu\n      const menus = this.$refs.postMenuRefs || [];\n      if (!menus.some(ref => ref.contains(event.target))) {\n        this.activeMenuIndex = null;\n      }\n\n      // Close Settings\n      const settings = this.$refs.settingsRef;\n      if (settings && !settings.contains(event.target)) {\n        this.showSettings = false;\n      }\n\n      // Close Share Popup\n      const sharePopup = this.$refs.sharePopupRef;\n      if (sharePopup && !sharePopup.contains(event.target)) {\n        this.showShareModal = false;\n      }\n    },\n    OffComment(index) {\n      this.posts[index].commentsDisabled = true;\n      this.activeMenuIndex = null;\n    },\n    copylink(index) {\n      const postId = this.posts[index].id;\n      const postUrl = `${window.location.origin}/post/${postId}`;\n      navigator.clipboard.writeText(postUrl).then(() => {\n        alert('Link copied!');\n      });\n    },\n    shareTo(index) {\n      this.activeSharedPostIndex = index;\n      this.showShareModal = true;\n    },\n    toggleReplyComment() {\n      this.replyCommentVisible = !this.replyCommentVisible;\n    },\n    handleInput(e) {\n      const cursorPos = e.target.selectionStart;\n      const textUpToCursor = this.newPost.substring(0, cursorPos);\n      const mentionMatch = textUpToCursor.match(/@(\\w*)$/);\n      if (mentionMatch) {\n        this.mentionQuery = mentionMatch[1].toLowerCase();\n        this.filteredUsers = this.users.filter(user => user.name.toLowerCase().startsWith(this.mentionQuery));\n        this.showMentionList = this.filteredUsers.length > 0;\n      } else {\n        this.showMentionList = false;\n      }\n    },\n    selectMention(username) {\n      nextTick(() => {\n        const textarea = this.textareaRef;\n        if (!textarea) return;\n        const cursorPos = textarea.selectionStart;\n        const textBeforeCursor = this.newPost.substring(0, cursorPos);\n        const textAfterCursor = this.newPost.substring(cursorPos);\n        const newTextBeforeCursor = textBeforeCursor.replace(/@\\w*$/, '@' + username + ' ');\n        this.newPost = newTextBeforeCursor + textAfterCursor;\n        nextTick(() => {\n          textarea.selectionStart = textarea.selectionEnd = newTextBeforeCursor.length;\n          textarea.focus();\n        });\n        this.showMentionList = false;\n      });\n    },\n    switchTab(tab) {\n      this.activeTab = tab;\n    },\n    openPostModal() {\n      //Story\n      this.composerType = null;\n      this.uploadedFiles = [], this.showPostModal = true;\n      this.composerType = null;\n      this.newPost = '';\n      this.mediaPreviews = [];\n\n      //\n\n      this.showPostModal = true;\n      nextTick(() => {\n        const textarea = document.querySelector('textarea[placeholder=\"What\\'s on your mind?\"]');\n        textarea?.focus();\n      });\n    },\n    closePostModal() {\n      // Revoke only on cancel\n      this.mediaPreviews.forEach(preview => URL.revokeObjectURL(preview.url));\n      this.mediaPreviews = [];\n      this.newPost = '';\n      this.postLocation = '';\n      this.postLink = null;\n      this.composerType = null;\n      this.showPostModal = false;\n    },\n    //FriensSearch\n    handleAddFriend(user) {\n      console.log('Add friend:', user);\n    },\n    handleFriendSelected(friend) {\n      this.selectedUser = friend;\n    },\n    togglechat() {\n      this.showChatPopup = !this.showChatPopup;\n    },\n    toggleSettings() {\n      this.showSettings = !this.showSettings;\n    },\n    closePopup() {\n      this.showRepostPopup = false;\n    }\n  },\n  watch: {\n    newPost(newVal, oldVal) {\n      //  URL \n      if (newVal !== oldVal) {\n        this.handlePostInput();\n      }\n    },\n    selectedMedia(newVal) {\n      if (newVal) {\n        window.addEventListener('keydown', this.handleKeydown);\n      } else {\n        window.removeEventListener('keydown', this.handleKeydown);\n      }\n    },\n    activeStory(story) {\n      clearTimeout(this.autoCloseTimer);\n      if (story) {\n        this.autoCloseTimer = setTimeout(() => {\n          this.nextStory();\n        }, 5000);\n      }\n    },\n    showLocationPopup(on) {\n      if (on) {\n        nextTick(() => {\n          this.locationInputRef?.focus();\n        });\n      }\n    }\n  },\n  mounted() {\n    //Get the Google/Email data from storage\n    const storedName = localStorage.getItem('userDisplayName');\n    const storedAvatar = localStorage.getItem('userAvatar');\n    const storedUserData = localStorage.getItem('newUserData');\n    if (storedName) {\n      this.currentUser.name = storedName;\n    } else if (storedUserData) {\n      try {\n        const parsed = JSON.parse(storedUserData);\n        this.currentUser.name = `${parsed.firstName} ${parsed.lastName}`;\n      } catch (e) {\n        console.error(\"Error parsing user data\", e);\n      }\n    }\n\n    // 3. Set Avatar if it exists in storage (Gmail URL)\n    if (storedAvatar && storedAvatar !== 'null' && storedAvatar !== 'undefined') {\n      this.currentUser.avatar = storedAvatar;\n    }\n\n    // this.listenRealtime();\n    document.addEventListener('click', this.handleClickOutside);\n    this.posts = this.posts.map(post => ({\n      ...post,\n      liked: false,\n      isFollowing: false,\n      //Follow post\n      showComments: false,\n      showShare: false,\n      newComment: '',\n      commentsList: post.commentsList || [],\n      commentMedia: post.commentMedia || [],\n      viewAll: false\n    }));\n  },\n  unmounted() {\n    document.removeEventListener('click', this.handleOutsideClick);\n    clearTimeout(this.autoCloseTimer);\n  }\n};","map":{"version":3,"names":["nextTick","Icon","EmojiPicker","CommentCard","Notify","ChatPanel","story1","story2","story3","story4","story5","sinayun","FriendSearch","aesp","name","components","data","following","showSearch","searchQuery","showResults","postLink","composerType","uploadedFiles","currentUser","avatar","username","uid","friends","id","showLikes","showNotify","notifications","media","currentIndex","newPost","showEmojiPickerIndex","mediaPreviews","activeStory","currentStoryIndex","autoCloseTimer","activeMenuIndex","editingIndex","editedCaption","storyScrollRef","sharePopupRefs","showShareModal","activeSharedPostIndex","showLocation","postLocation","replyCommentVisible","touchStartX","touchEndX","selectedMedia","selectedIndex","activePostMedia","activePreview","scrollContainer","showLocationPopup","locationInput","suggestions","desc","locationInputRef","tags","showMentionList","mentionQuery","filteredUsers","textareaRef","users","followers","showPostModal","showChatPopup","selectedUser","suggestedFriends","time","showSettings","showRepostPopup","showSharePopup","replyText","stories","type","liked","suggestedUsers","posts","userId","user","Caption","url","likes","shares","isFollowing","showComments","showShare","newComment","commentMedia","commentsList","commentsDisabled","computed","filteredSearchUsers","filter","u","toLowerCase","includes","methods","openProfile","index","console","log","handlePostInput","handleMentionInput","urlRegex","match","trim","enrichedLink","detectLinkType","cleanUrl","replace","response","fetch","encodeURIComponent","json","info","title","description","image","screenshot","domain","URL","hostname","err","charAt","toUpperCase","slice","addCommentImage","event","file","target","files","post","$set","push","createObjectURL","value","getYouTubeId","regExp","length","handleCommentMediaUpload","Array","from","forEach","startsWith","toggleFollowUser","find","i","indexOf","splice","toggleMenu","toggleFollow","toggleSearch","closeIfEmpty","handleSearch","onSearchFocus","selectSearchUser","$router","listenRealtime","setInterval","newNotification","Date","now","action","toLocaleTimeString","unshift","openLikesPopup","goToMainfeed","window","location","reload","goToProfileUser","goLogin","localStorage","clear","sessionStorage","handleTouchStart","e","changedTouches","screenX","handleTouchEnd","handleSwipe","distance","prevMedia","nextMedia","openMediaModal","mediaList","findIndex","m","closeMediaModal","handleKeydown","key","openPreview","closePreview","removeMedia","removeCommentMedia","postIndex","mediaIndex","revokeObjectURL","handleFileUpload","newFiles","map","raw","size","removeFile","handleDrop","dataTransfer","togglePostEmojiPicker","showPostEmojiPicker","EmojiToPost","emoji","toggleEmojiPicker","addEmojiToComment","submitPost","alert","$nextTick","container","$refs","scrollLeft","resetComposer","linkCopy","newPostObj","caption","preview","link","viewAll","countTotalComments","comments","count","comment","replies","toggleLike","toggleSharePopup","addCommentToPost","text","isArray","defaultAvatar","autoResize","el","style","height","scrollHeight","getLocation","navigator","geolocation","getCurrentPosition","pos","latitude","longitude","coords","then","res","address","city","town","village","catch","error","message","confirmLocation","closeLocation","pickSuggestion","s","formatCount","num","toFixed","toString","updateCommentCount","toggleCommentSection","toggleComment","confirmDelete","startEditPost","saveEditedPost","cancelEdit","scrollStories","direction","scrollAmount","scrollBy","left","behavior","canScrollLeft","canScrollRight","clientWidth","scrollWidth","openStory","progress","closeStory","clearTimeout","nextStory","prevStory","sendReply","copyLink","clipboard","writeText","href","shareToFacebook","fbUrl","open","shareToTelegram","tgUrl","shareToMessenger","appId","msgUrl","handleClickOutside","wrapper","emojiWrapper","contains","handleOutsideClick","emojiPickers","emojiPickerRefs","some","ref","menus","postMenuRefs","settings","settingsRef","sharePopup","sharePopupRef","OffComment","copylink","postId","postUrl","origin","shareTo","toggleReplyComment","handleInput","cursorPos","selectionStart","textUpToCursor","substring","mentionMatch","selectMention","textarea","textBeforeCursor","textAfterCursor","newTextBeforeCursor","selectionEnd","focus","switchTab","tab","activeTab","openPostModal","document","querySelector","closePostModal","handleAddFriend","handleFriendSelected","friend","togglechat","toggleSettings","closePopup","watch","newVal","oldVal","addEventListener","removeEventListener","story","setTimeout","on","mounted","storedName","getItem","storedAvatar","storedUserData","parsed","JSON","parse","firstName","lastName","unmounted"],"sources":["D:\\login-feed\\src\\views\\Mainfeed.vue"],"sourcesContent":["\r\n<template>\r\n<div class=\" w-95  flex flex-col md:flex-row min-h-[100dvh] bg-white \">\r\n\r\n\r\n<!-- Left Sidebar -->\r\n<aside class=\"w-20 bg-white border-r border-gray-200 sticky top-0 h-[100dvh] flex flex-col items-center py-8 space-y-8 hidden md:flex\">\r\n\r\n  <!--Logo Icon  -->\r\n  <button \r\n    @click=\"goToMainfeed\"\r\n    class=\"p-3 rounded-xl  transition-all duration-200 group\">\r\n    <Icon icon=\"tdesign:chat-bubble\" \r\nclass=\"w-10 h-10 text-white transition-colors bg-green-500\r\n border-4 border-green-500 rounded-xl duration-200 hover:text-gray-600 mb-10\" \r\n    />\r\n  </button>\r\n\r\n  <!-- Search Reused-->\r\n  <div class=\"relative  pl-3\">\r\n\r\n    <FriendSearch\r\n    :users=\"friends\"\r\n    action-text=\"Follow\"\r\n    @select=\"handleFollow\"/>\r\n  </div>\r\n\r\n\r\n\r\n  <!-- Navigation Icons -->\r\n  <nav class=\"flex-1 flex flex-col items-center space-y-6 justify-center\">\r\n    \r\n    <!-- Notifications  heart icon  -->\r\n    <button @click=\"showNotify = true\"\r\n            class=\"relative p-3 rounded-xl hover:bg-gray-300 transition-all duration-200 group\">\r\n      <Icon icon=\"solar:heart-outline\" class=\"w-7 h-7 text-gray-600 group-hover:text-gray-900\"/>\r\n      <span v-if=\"notifications.length > 0\"\r\n            class=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center shadow-md\">\r\n        {{ notifications.length > 99 ? '99+' : notifications.length }}\r\n      </span>\r\n    </button>\r\n\r\n    <!-- Home -->\r\n    <button class=\"p-3 rounded-xl hover:bg-gray-300 transition-all duration-200 group\">\r\n      <Icon icon=\"proicons:home\" \r\n      class=\"w-7 h-7 text-gray-600 group-hover:text-gray-900\"/>\r\n    </button>\r\n\r\n    <!-- Create Post-->\r\n    <button @click=\"openPostModal\"\r\n            class=\"p-4 rounded-xl hover:bg-gray-50 transition-all duration-300 group\">\r\n      <div class=\"p-1 bg-gray-400 border-4 border-gradient-to-br from-blue-600 to-green-500\r\n       rounded-xl shadow-lg\r\n        group-hover:shadow-xl group-hover:scale-110 transition-all duration-300\">\r\n        <Icon icon=\"ic:baseline-plus\"\r\n         class=\"w-10 h-8 text-gray-500\"/>\r\n       \r\n      </div>\r\n    </button>\r\n    \r\n<div>\r\n<button class=\"\">\r\n<Icon icon=\"fluent:video-short-32-regular\" class=\"w-6 h-6\"/>\r\n</button>\r\n</div>\r\n  \r\n\r\n\r\n<!-- Reusable Notification Popup  -->\r\n  <Notify\r\n    v-model=\"showNotify\"\r\n    :notifications=\"notifications\"/> \r\n<!------>\r\n\r\n\r\n\r\n\r\n\r\n\r\n<teleport to=\"body\">\r\n<!-- Floating Composer Modal -->\r\n <div\r\n      v-if=\"showPostModal\"\r\n      class=\"fixed inset-0 bg-black bg-opacity-50\r\n       flex items-center justify-center z-[9999]\"\r\n      @click.self=\"closePostModal\">\r\n      <div class=\"bg-white w-full max-w-xl rounded-xl p-6 relative\" @click.stop>\r\n\r\n        <!-- Close Button -->\r\n        <button @click=\"closePostModal\" \r\n        class=\"absolute top-2 right-2 text-gray-500 hover:text-black text-2xl\">\r\n          <Icon icon=\"basil:cross-solid\" />\r\n        </button>\r\n\r\n        <!-- Story / Post Selector -->\r\n        <div v-if=\"!composerType\" class=\"bg-white w-h-full rounded-xl p-6 space-y-2 \">\r\n          <h2 class=\"text-center font-semibold text-lg\">\r\n            Create</h2>\r\n\r\n          <button @click=\"composerType = 'story'\"\r\n           class=\"w-full flex items-center gap-3 p-4 border rounded-xl hover:bg-gray-100\">\r\n            <Icon icon=\"fluent-color:history-32\"\r\n             class=\"w-8 h-8 text-green-600\" />\r\n            <p class=\"font-medium\">Create Story</p>\r\n          </button>\r\n          <button @click=\"composerType = 'post'\" \r\n          class=\"w-full flex items-center gap-3 \r\n          p-4 border rounded-xl hover:bg-gray-100\">\r\n            <Icon icon=\"system-uicons:postcard\" \r\n            class=\"w-8 h-8 text-blue-500\" />\r\n            <span class=\"font-medium\">\r\n              Create Post</span>\r\n          </button>\r\n        </div>\r\n\r\n        <!-- Composer UI -->\r\n        <div v-if=\"composerType\">\r\n          <!-- Caption / Textarea -->\r\n\r\n\r\n          <textarea\r\n            ref=\"textareaRef\"\r\n            v-model=\"newPost\"\r\n            @input=\"handlePostInput\"\r\n            :placeholder=\"composerType === 'story' ? 'Add a caption to your story...'\r\n             : 'What\\'s on your mind?'\"\r\n            class=\"w-full border border-gray-300 rounded-xl \r\n            p-3 focus:outline-none focus:ring-2 \r\n            focus:ring-blue-300 resize-none mb-4 bg-white/90\">\r\n        </textarea>\r\n\r\n          <!-- Upload Media -->\r\n          <label class=\"cursor-pointer flex items-center gap-2 mb-4\" title=\"Upload Media\">\r\n            <Icon icon=\"proicons:photo\" class=\"w-8 h-8 text-blue-500\" />\r\n          \r\n            <span class=\"font-medium\">\r\n              \r\n              {{ composerType === 'story' ? 'Add to Story' : 'Upload Post' }}</span>\r\n            <input\r\n              type=\"file\"\r\n              accept=\"image/*,video/*\"\r\n              multiple\r\n              class=\"hidden\"\r\n              @change=\"handleFileUpload\"/>\r\n              \r\n          </label>\r\n<!----->\r\n\r\n\r\n\r\n\r\n\r\n<!-- Action Icons  Post Right aligned -->\r\n<div class=\"flex justify-end items-center gap-4 text-gray-600 mb-3 px-2\">\r\n<!-- Location Icon Button -->\r\n<button @click=\"getLocation\" title=\"Location\">\r\n<Icon icon=\"mynaui:location\" class=\"w-5 h-5\" />\r\n</button>\r\n\r\n<!-- Location Popup Modal -->\r\n<teleport to=\"body\">\r\n<div\r\nv-if=\"showLocationPopup\"\r\nclass=\"fixed inset-0 z-[10000] flex items-center justify-center bg-black/50\"\r\n@keydown.esc=\"closeLocation\"\r\ntabindex=\"-1\"\r\n@click.self=\"closeLocation\" >\r\n\r\n<!-- Card -->\r\n<div\r\nclass=\"bg-white rounded-2xl shadow-xl w-[420px] max-w-[92vw] h-[70vh] max-h-[720px] overflow-hidden flex flex-col\"\r\n@click.stop>\r\n\r\n\r\n\r\n<!-- Header -->\r\n<div class=\"h-12 flex items-center justify-center border-b relative\">\r\n<button\r\nclass=\"absolute left-2 p-2 rounded hover:bg-gray-100\"\r\n@click=\"closeLocation\"\r\naria-label=\"Back\">\r\n<Icon icon=\"mdi:chevron-left\" class=\"w-5 h-5\" />\r\n</button>\r\n\r\n<h2 class=\"text-sm font-semibold\">Choose a Place</h2>\r\n<button\r\nclass=\"absolute right-2 p-2 rounded hover:bg-gray-100\"\r\n@click=\"closeLocation\"\r\naria-label=\"Close\">\r\n\r\n<Icon icon=\"material-symbols:close\"/>\r\n</button>\r\n</div>\r\n\r\n\r\n\r\n\r\n<!-- Body -->\r\n<div class=\"p-4 flex-1\">\r\n<div class=\"relative\">\r\n<input\r\nref=\"locationInputRef\"\r\n v-model=\"locationInput\"\r\n type=\"text\"\r\n placeholder=\"Add Location...\"\r\nclass=\"w-full px-4 py-2 pr-10 rounded-lg bg-gray-200/70 text-sm outline-none\"\r\n@keyup.enter=\"confirmLocation\"/>\r\n\r\n<button\r\nclass=\"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-gray-100 text-gray-600 hover:text-green-600\"\r\n@click=\"confirmLocation\"\r\naria-label=\"Send\">\r\n<Icon icon=\"ph:paper-plane-tilt-duotone\" class=\"w-5 h-5\" />\r\n</button>\r\n</div>\r\n\r\n\r\n\r\n\r\n<!-- Optional suggestions list -->\r\n<div v-if=\"suggestions.length\" class=\"mt-4 space-y-2 overflow-y-auto max-h-[48vh] pr-1\">\r\n<button\r\nv-for=\"(s, i) in suggestions\"\r\n:key=\"i\"\r\nclass=\"w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100\"\r\n@click=\"pickSuggestion(s)\">\r\n<div class=\"text-sm font-medium\">{{ s.name }}</div>\r\n<div class=\"text-xs text-gray-500\">{{ s.desc }}</div>\r\n</button>\r\n</div>\r\n</div>\r\n</div>\r\n</div>\r\n</teleport>\r\n\r\n<!-- Location Popup Modal -->\r\n\r\n\r\n\r\n\r\n\r\n<!-- Comment icon -->                                                     \r\n<button @click=\"toggleReplyComment\" title=\"Comment\">\r\n<Icon icon=\"iconamoon:comment\" class=\"w-5 h-5 \" />\r\n</button>\r\n\r\n<!-- Emoji Picker icon -->\r\n<div class=\"relative\" ref=\"emojiWrapper\">\r\n  <button\r\n    @click.stop=\"toggleEmojiPicker('composer')\"\r\n    title=\"Emoji\">\r\n  <Icon icon=\"mingcute:emoji-line\" class=\"w-5 h-5 mr-5 mt-2\" />\r\n  </button>\r\n\r\n  <div\r\n  v-if=\"showEmojiPickerIndex === 'composer'\"\r\n  class=\"absolute z-50 top-8 right-0\"\r\n  @click.stop>\r\n  <EmojiPicker @select=\"EmojiToPost\" />\r\n  </div>\r\n  </div>\r\n\r\n\r\n<!-- Post Button-->\r\n<button\r\n  class=\"text-sm font-semibold text-gray-700 hover:text-blue-600\"\r\n  @click=\"submitPost\">\r\n  {{ composerType === 'story' ? 'Share Story' : 'Post' }}\r\n</button>\r\n\r\n</div>\r\n<!-- Post -->\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<!-- Preview Modal for Media before  post  -->\r\n<div\r\n v-if=\"activePreview\"\r\n class=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80\">\r\n<div class=\"relative max-w-3xl w-full max-h-[90vh]\">\r\n<button\r\n@click=\"closePreview\"\r\nclass=\"fixed top-6 right-6 z-50 text-white bg-black bg-opacity-50   p-2 rounded-full hover:bg-opacity-70\">\r\n\r\n\r\n\r\n<Icon icon=\"mdi:close\" class=\"w-6 h-6\" />\r\n</button>\r\n<component\r\n:is=\"activePreview.type.startsWith('video') ? 'video' : 'img'\"\r\n:src=\"media.url\"\r\nclass=\"w-auto max-w-full max-h-[90vh] object-contain mx-auto rounded-xl\"\r\ncontrols\r\nautoplay/>\r\n</div>\r\n</div>\r\n\r\n\r\n\r\n\r\n<!-- Media Previews -->\r\n\r\n<div v-if=\"mediaPreviews.length\" class=\"grid grid-cols-2 gap-2 mt-2\">\r\n<div\r\nv-for=\"(file, index) in mediaPreviews\"\r\n:key=\"index\"\r\nclass=\"relative group rounded-lg overflow-hidden border cursor-pointer\"\r\n@click=\"openPreview(file)\">\r\n<component\r\n:is=\"file.type.startsWith('video') ? 'video' : 'img'\"\r\n:src=\"file.url\"\r\nclass=\"w-full h-48 object-cover\"\r\ncontrols/>\r\n<button\r\n@click.stop=\"removeMedia(index)\"\r\nclass=\"relative\">\r\n<Icon icon=\"mdi:close\" class=\"w-4 h-4\" />\r\n</button>\r\n\r\n\r\n\r\n </div>\r\n</div>\r\n</div> \r\n\r\n\r\n\r\n<!--When  Post a Composer\r\n -->\r\n</div>\r\n</div>\r\n</teleport>\r\n</nav>\r\n\r\n<div class=\"mt-40 mb-5 relative\">\r\n  \r\n  <!-- Settings Icon -->\r\n  <div \r\n  @click=\"toggleSettings\"  \r\n  class=\"p-3 rounded-xl hover:bg-gray-300 transition-all duration-200 group\">\r\n  <Icon icon=\"famicons:reorder-three-outline\"  \r\n  class=\"w-8 h-8 text-gray-500 transition-colors duration-200 hover:text-gray-600\"/>  <!---Setting-->\r\n  </div>\r\n </div>\r\n</aside>   \r\n\r\n\r\n\r\n <div>\r\n<!-- Settings Popup -->\r\n<teleport to=\"body\">\r\n  <!-- Overlay (click outside) -->\r\n  <div\r\n  v-if=\"showSettings\"\r\n  class=\"fixed inset-0 z-40\"\r\n  @click.self=\"showSettings = false\">\r\n\r\n\r\n    <!-- Popup -->\r\n    <div\r\n    class=\"flex top-20 left-40 w-72 bg-white shadow-lg border-2 border-gray-300 rounded-xl p-4 button-10\">\r\n    <!-- Menu Sections -->\r\n    <div class=\"divide-y bg-white\">\r\n\r\n        <!-- Section 1 -->\r\n        <div>\r\n        <div class=\"py-3 flex justify-between items-center cursor-pointer hover:bg-gray-50 px-2 rounded\">\r\n          <span class=\"font-medium\">Switch Mode</span>\r\n          <Icon icon=\"ooui:next-ltr\"/>\r\n          </div>\r\n          <div class=\"py-3 px-2 cursor-pointer hover:bg-gray-50 \r\n          rounded\">Daily Review</div>\r\n          <div class=\"py-3 px-2 cursor-pointer hover:bg-gray-50 \r\n          rounded\">Setting</div>\r\n        </div>\r\n\r\n        <!-- Section 2 -->\r\n    <div>\r\n    <div class=\"py-3 flex justify-between items-center cursor-pointer hover:bg-gray-200 px-2 rounded\">\r\n    <button>\r\n     iFeed\r\n    </button>\r\n    <Icon icon=\"ooui:next-ltr\"/>\r\n    </div>\r\n    <div class=\"py-3 px-2 cursor-pointer hover:bg-gray-200 rounded\">Feedback</div>\r\n    <div class=\"py-3 px-2 cursor-pointer hover:text-gray-600 rounded flex items-center gap-2\">\r\n    <Icon icon=\"akar-icons:heart\" class=\"w-8 h-8\"/>\r\n    </div>\r\n    </div>\r\n\r\n<!-- Logout -->\r\n    <div>\r\n    <div class=\"py-3 px-2 cursor-pointer hover:bg-gray-50 rounded text-red-500 flex items-center gap-2\">\r\n    <Icon\r\n    icon=\"material-symbols:logout\"\r\n    class=\"w-8 h-8 cursor-pointer\"\r\n          \r\n    @click=\"goLogin\"/>\r\n    </div>\r\n    </div>\r\n\r\n    </div>\r\n    </div>\r\n    </div>\r\n    </teleport>\r\n    </div>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<!-- MainiFeed -->\r\n<main class=\"flex-5 max-w-2xl mx-auto px-10 py-5 \">\r\n\r\n<!-- STORIES WRAPPER -->\r\n<div class=\"relative w-full mb-4\">\r\n\r\n  <!-- Stories Container -->\r\n  <div\r\n    ref=\"storyScrollRef\"\r\n    class=\"flex gap-4 overflow-x-auto scroll-smooth px-2 no-scrollbar\">\r\n\r\n\r\n    <!-- Normal Stories -->\r\n    <div\r\n      v-for=\"(story, i) in stories\"\r\n      :key=\"story.id\"\r\n      @click=\"openStory(i)\"\r\n      class=\"flex flex-col items-center flex-shrink-0 w-[90px] cursor-pointer hover:brightness-90 transition\">\r\n\r\n      <!-- Circle Story Ring -->\r\n      <div\r\n        :class=\"story.viewed \r\n          ? 'border-2 border-gray-300' \r\n          : 'p-[3px] bg-gradient-to-tr from-blue-500 to-purple-500 rounded-full'\">\r\n\r\n        <img\r\n          :src=\"story.media\"\r\n          class=\"w-20 h-20 rounded-full object-cover bg-white\"/>\r\n      </div>\r\n\r\n      <p class=\"text-xs mt-2 text-gray-700 truncate w-full text-center\">\r\n        {{ story.username }}\r\n      </p>\r\n    </div>\r\n\r\n  </div>\r\n\r\n  <!-- LEFT ARROW -->\r\n  <button\r\n    @click=\"scrollStories('left')\"\r\n    class=\"absolute left-1 top-1/2 -translate-y-1/2 bg-white shadow rounded-full p-1 z-20\">\r\n    <Icon icon=\"ic:round-chevron-left\" class=\"w-5 h-5\" />\r\n  </button>\r\n\r\n  <!-- RIGHT ARROW -->\r\n<button\r\n@click=\"scrollStories('right')\"\r\nclass=\"absolute right-1 top-1/2 -translate-y-1/2 bg-white shadow rounded-full p-1 z-20\">\r\n<Icon icon=\"ic:round-chevron-right\" class=\"w-5 h-5\" />\r\n </button>\r\n</div>\r\n\r\n\r\n\r\n\r\n\r\n<!--Button Category-->\r\n<div class=\"flex gap-4 mb-6  \">\r\n<button>\r\n<span>All</span>\r\n</button>\r\n\r\n<button>\r\n<span class=\"text-sm\">Entertainment</span>\r\n</button>\r\n\r\n\r\n<button>\r\n<span class=\"text-sm \">Music</span>\r\n</button>\r\n\r\n<button>\r\n<span class=\"text-sm \">Travel</span>\r\n</button>\r\n\r\n\r\n</div>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<!--Post a Composer 1  box Media post -->\r\n<div v-for=\"(post, index) in posts\" :key=\"post.id\"\r\n class=\"bg-white border rounded-xl shadow-sm p-4  relative  \">\r\n<!-- Post Header -->\r\n\r\n<div class=\"flex items-center justify-between mb-2 rounded-xl\">\r\n\r\n<!-- Avatar  User Info -->\r\n<div class=\"flex items-center gap-2 \">\r\n<img\r\n:src=\"post.avatar\"\r\nalt=\"User Avatar\"\r\nclass=\"w-10 h-10 rounded-full border border-gray-200 object-cover shadow-sm\"/>\r\n<div>\r\n<h2 class=\"text-sm font-semibold text-gray-800\">{{ post.user }}</h2>\r\n<p class=\"text-xs text-gray-400\">{{ post.time }}</p>\r\n<!---Location text-->\r\n<p v-if=\"post.location\" class=\"text-xs text-gray-400\">{{ post.location }}</p>\r\n\r\n</div>\r\n</div>\r\n\r\n<div class=\"flex items-center gap-2\">\r\n  <!-- Follow Button -->\r\n  <button\r\n    @click=\"toggleFollow(index)\"\r\n    class=\"text-sm px-3 py-1\"\r\n    :class=\"post.isFollowing\r\n      ? 'text-gray-700'\r\n      : 'text-gray-700 hover:text-blue-500'\">\r\n    {{ post.isFollowing ? 'Following' : 'Follow' }}\r\n  </button>\r\n\r\n\r\n\r\n  \r\n \r\n  <!-- Three-dot Menu -->\r\n<div class=\"relative z-20 pointer-events-auto\">\r\n  <button\r\n    type=\"button\"\r\n    @click.stop=\"toggleMenu(index)\"\r\n    class=\"p-1 hover:bg-gray-100 rounded-full\">\r\n  <Icon icon=\"bi:three-dots\" class=\"w-5 h-5 text-gray-600\" />\r\n  </button>\r\n\r\n  <!-- Dropdown Menu -->\r\n  <div\r\n  v-if=\"activeMenuIndex === index\"\r\n  class=\"absolute right-0 mt-2 w-52 bg-white border border-gray-200 rounded-xl shadow-lg z-50\">\r\n    <ul class=\"text-sm text-gray-700 py-2\">\r\n\r\n      <li\r\n        @click=\"startEditPost(index)\"\r\n        class=\"flex items-center justify-between px-4 py-2 hover:bg-gray-100 cursor-pointer\">\r\n        Edit Caption\r\n        <Icon icon=\"lucide:edit\" class=\"w-4 h-4\"/>\r\n      </li>\r\n      \r\n      <li\r\n        @click=\"confirmDelete(index)\"\r\n        class=\"flex items-center justify-between px-4 py-2 hover:bg-gray-100 text-red-600 cursor-pointer\">\r\n        Delete Post\r\n        <Icon icon=\"fluent:delete-32-regular\" class=\"w-4 h-4\" />\r\n      </li>\r\n\r\n<li\r\n  @click=\"toggleComment(index)\"\r\n  class=\"flex items-center justify-between px-4 py-2 hover:bg-gray-100 cursor-pointer\">\r\n  {{ posts[index].commentsDisabled ? 'On Comment' : 'Off Comment' }}\r\n  <Icon\r\n    :icon=\"posts[index].commentsDisabled ? 'fluent:comment-48-regular' : 'fluent:comment-off-48-regular'\"\r\n    class=\"w-4 h-4\"/>\r\n</li>\r\n\r\n      <li\r\n        @click=\"copylink(index)\"\r\n        class=\"flex items-center justify-between px-4 py-2 hover:bg-gray-100 cursor-pointer\">\r\n        Copy Link\r\n        <Icon icon=\"ri:link\" class=\"w-4 h-4\" />\r\n      </li>\r\n\r\n      <li\r\n        @click=\"shareTo(index)\"\r\n        class=\"flex items-center justify-between px-4 py-2 hover:bg-gray-100 cursor-pointer\">\r\n        Report Post\r\n        <Icon icon=\"ri:link\" class=\"w-4 h-4\" />\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n<!----Open Model sent to frien-->\r\n  <div v-if=\"showShareModal\" class=\"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50\">\r\n  <div class=\"bg-white w-96 p-6 rounded-xl shadow-xl relative\">\r\n  <button @click=\"showShareModal = false\"\r\n   class=\"absolute top-2 right-2\">\r\n  <Icon icon=\"mdi:close\" class=\"w-5 h-5\" />\r\n  </button>\r\n  <h2 class=\"text-lg font-semibold mb-4\">Report</h2>\r\n  <p>Post ID: {{ posts[activeSharedPostIndex]?.id }}</p>\r\n <!-- Add actual sharing buttons here -->\r\n   </div>\r\n   </div>\r\n   </div>\r\n   </div>\r\n   </div>\r\n<!-- Dropdown Menu buttonm-->\r\n\r\n\r\n\r\n\r\n\r\n\r\n<!-- Caption or Editable -->\r\n  <div class=\"mb-4\">\r\n  <div v-if=\"editingIndex === index\">\r\n        <input v-model=\"editedCaption\"\r\n         class=\"w-full border px-3 py-1 rounded focus:outline-none\" />\r\n        <div class=\"text-right mt-1\">\r\n        <button class=\"text-green-600 text-sm font-semibold hover:underline mr-2\"\r\n         @click=\"saveEditedPost(index)\">Save</button>\r\n        <button class=\"text-gray-500 text-sm hover:underline\"\r\n         @click=\"cancelEdit\">Cancel</button>\r\n        </div>\r\n        </div>\r\n        <p v-else> {{ post.caption }}</p>\r\n        </div>\r\n\r\n\r\n\r\n\r\n\r\n<!-- Website Link Preview Card -->\r\n<div\r\n  v-if=\"post.link && post.link.type === 'website'\"\r\n  class=\"mt-4 border rounded-xl overflow-hidden hover:shadow-md transition-shadow cursor-pointer\"\r\n  @click=\"window.open(post.link.url, '_blank')\">\r\n  <div v-if=\"post.link.image\" class=\"w-full h-48 bg-gray-200\">\r\n    <img :src=\"post.link.image\" class=\"w-full h-full object-cover\" />\r\n  </div>\r\n  <div class=\"p-3 bg-white\">\r\n    <p class=\"text-sm font-medium text-gray-900 line-clamp-2\">\r\n      {{ post.link.title || 'Untitled' }}</p>\r\n    <p v-if=\"post.link.description\" \r\n    class=\"text-xs text-gray-600 mt-1 line-clamp-2\">\r\n      {{ post.link.description }}</p>\r\n    <p class=\"text-xs text-gray-500 mt-2 truncate\">\r\n      {{ post.link.domain }}</p>\r\n  </div>\r\n</div>\r\n\r\n  <!-- YouTube Link -->\r\n  <iframe\r\n    v-if=\"post && post.link && post.link.type === 'youtube' && post.link.url\"\r\n    :src=\"`https://www.youtube.com/embed/${getYouTubeId(post.link.url)}`\"\r\n    class=\"w-full aspect-video rounded-xl mt-2\"\r\n    allowfullscreen>\r\n</iframe>\r\n\r\n<!-- Open Photo Post Media  sinayun_xyn 1h ago ) -->\r\n\r\n<div\r\n  ref=\"scrollContainer\"\r\n  class=\"flex gap-2 overflow-x-auto no-scrollbar snap-x snap-mandatory cursor-pointer\"\r\n>\r\n  <component\r\n    v-for=\"(media, i) in post.media\"\r\n    :key=\"i\"\r\n    :is=\"media.type.startsWith('video') ? 'video' : 'img'\"\r\n    :src=\"media.url\"\r\n    class=\"rounded-xl flex-shrink-0 snap-start hover:brightness-75 transition h-72 object-contain\"\r\n    controls\r\n    @click=\"openMediaModal(media, post.media)\"/>\r\n</div>\r\n\r\n<!-- Media Fullscreen Viewer with Navigation -->\r\n  <div\r\n  v-if=\"selectedMedia\"\r\n  class=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80\"\r\n  @touchstart=\"handleTouchStart\"\r\n  @touchend=\"handleTouchEnd\">\r\n\r\n\r\n\r\n<!-- Close -->\r\n <button\r\n  @click=\"closeMediaModal\"\r\n  class=\"cursor-pointer\r\n   absolute top-4 right-4 z-50 text-white bg-black bg-opacity-60 p-2 rounded-full hover:bg-opacity-80\">\r\n<Icon icon=\"mdi:close\" class=\"w-6 h-6 text-white\" />\r\n</button>\r\n\r\n<!-- Icon Prev -->\r\n \r\n<button\r\nv-if=\"selectedIndex > 0\"\r\n        @click.stop=\"prevMedia\"\r\n        class=\"cursor-pointer absolute left-4 top-1/2 z-50 transform -translate-y-1/2 bg-black bg-opacity-60 text-white p-2 rounded-full hover:bg-opacity-80\">\r\n      <Icon icon=\"ooui:previous-ltr\" class=\"w-6 h-6 text-white\" />\r\n      </button>\r\n\r\n      <!-- Icon Next -->\r\n      <button\r\n        v-if=\"selectedIndex < activePostMedia.length - 1\"\r\n        @click.stop=\"nextMedia\"\r\n        class=\"cursor-pointer absolute right-4 top-1/2 -translate-y\">\r\n        <Icon icon=\"ooui:next-ltr\" class=\"w-6 h-6 text-white\" />\r\n      </button>\r\n\r\n    <!-- Media Viewer -->\r\n      <component\r\n        :is=\"selectedMedia.type.startsWith('video') ? 'video' : 'img'\"\r\n        :src=\"selectedMedia.url\"\r\n        class=\"max-w-full max-h-[90vh] object-contain rounded-xl\"\r\n        controls\r\n        autoplay/>\r\n    </div>\r\n  \r\n<!-- Media Fullscreen Viewer with Navigation -->\r\n\r\n\r\n\r\n\r\n\r\n\r\n<!-- Post Actions  ICon heart comment share -->\r\n<div class=\"flex items-center gap-4 text-gray-500 text-sm mt-4 mb-10\">\r\n      \r\n<!-- Like -->\r\n\r\n<div class=\"flex items-center gap-4 cursor-pointer hover:text-red-500\"\r\n @click=\"toggleLike(index)\">\r\n\r\n <!--Heart Like RedColor-->\r\n \r\n<Icon :icon=\"post.liked ? 'fluent-emoji:red-heart' : 'octicon:heart-24'\"\r\n class=\"w-5 h-5\" />\r\n\r\n<p>{{ formatCount(post.likes||[]) }}</p>\r\n</div>\r\n\r\n<!-- Comment -->\r\n<div class=\"flex items-center gap-4 cursor-pointer hover:text-blue-500\"\r\n @click=\"toggleCommentSection(index)\">\r\n<Icon icon=\"tdesign:chat-bubble\" class=\"w-5 h-5\"/>\r\n<p>{{ formatCount(post.commentsList?.length ||[]) }}</p>\r\n</div>  \r\n <div>\r\n\r\n\r\n\r\n       \r\n<!-- Share Plan Icon Button and Dropdown -->\r\n\r\n<div class=\"relative\">\r\n<button \r\n@click.stop=\"showRepostPopup = true\" \r\n class=\"p-2 hover:text-gray-500 relative z-10  duration-100 \">\r\n<Icon icon=\"mage:direction-up-right-2\" class=\"w-5 h-5\"/> <!-- Air Plan Share Popup -->\r\n</button>\r\n\r\n<!-- Teleported Popup -->\r\n<teleport to=\"body\">\r\n<div \r\n v-if=\"showRepostPopup\" \r\nclass=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\"\r\n@click=\"closePopup\">\r\n<!-- Popup Content -->\r\n<div \r\nclass=\"bg-white rounded-xl p-4 w-[420px] relative\"\r\n@click.stop>\r\n\r\n\r\n<!-- Header -->\r\n<div class=\"flex justify-between items-center mb-3\">\r\n<h2 class=\"text-lg font-bold\">\r\niFeed\r\n</h2>\r\n<button\r\n @click=\"closePopup\" class=\"text-gray-500 hover:text-black\"> \r\n<Icon icon=\"ri:close-line\"/>\r\n</button>\r\n</div>\r\n\r\n<!-- Post Input -->                                                                                                                                        <!-- Repost Button  -->\r\n<div class=\"flex items-center space-x-3 mb-4\">\r\n<img :src=\"currentUser.avatar\" class=\"w-10 h-10 rounded-full\" />\r\n<input type=\"text\" placeholder=\"Write something...\" class=\"flex-1 border rounded px-2 py-1\" />\r\n</div>\r\n\r\n\r\n<!-- Sent to Friend -->\r\n<div class=\"mb-4\">\r\n<p class=\"font-semibold mb-1\">\r\n  Peolpe \r\n</p>\r\n\r\n\r\n<!---List of Friends-->\r\n<div class=\"flex -space-x-2 items-center\">\r\n  <img\r\n    v-for=\"(friend, index) in friends.slice(0, 5)\"\r\n    :key=\"index\"\r\n    :src=\"friend\"\r\n    class=\"w-10 h-10 rounded-full border-2 border-white object-cover\"/>\r\n\r\n  <div\r\n    v-if=\"friends.length > 5\"\r\n    class=\"w-10 h-10 rounded-full bg-gray-200 flex items-center\r\n           justify-center text-sm font-semibold border-2 border-white\">\r\n    +{{ friends.length - 5 }}\r\n  </div>\r\n</div>\r\n  \r\n</div>\r\n\r\n<!-- Share To -->\r\n \r\n<div>\r\n<p class=\"font-semibold mb-1\">Share To</p>\r\n<div class=\"flex space-x-4\">\r\n<button class=\"flex flex-col items-center text-sm\">\r\n<Icon icon=\"ri:link\" class=\"w-10 h-10\"/>\r\n<span>Copy</span>\r\n</button>\r\n<button class=\"flex flex-col items-center text-sm\">\r\n  <Icon icon=\"logos:telegram\" class=\"w-10 h-10\"/>\r\n<span>\r\n  Telegram\r\n</span>\r\n</button>\r\n<button class=\"flex flex-col items-center text-sm\">\r\n  <Icon icon=\"logos:facebook\" class=\"w-10 h-10\"/>\r\n<span>Facebook</span>\r\n</button>\r\n<button class=\"flex flex-col items-center text-sm item-center\">\r\n<Icon icon=\"tdesign:chat-bubble\"\r\n class=\"w-10 h-10 text-white \r\n transition-colors bg-green-500 \r\n border-4 border-green-500 rounded-xl\r\n  duration-200 hover:text-gray-600\"/>\r\n<span>iFeed</span>\r\n</button>\r\n</div>\r\n</div>\r\n</div>\r\n</div>\r\n</teleport>\r\n\r\n \r\n\r\n</div>\r\n\r\n\r\n</div>\r\n</div>\r\n\r\n\r\n \r\n\r\n\r\n\r\n <!-- Comment Reply Box -->\r\n  <div v-if=\"post.showComments\" \r\n  class=\"max-w-sl rounded-full mx-auto px-4 py-4 \">\r\n\r\n    <!-- View All Toggle -->\r\n  <div\r\n    class=\"text-gray-400 text-sm mb-1 cursor-pointer hover:text-gray-500\"\r\n   @click=\"post.viewAll = !post.viewAll\">\r\n   All {{countTotalComments (post.commentsList) }}\r\n  comments \r\n  </div>\r\n\r\n  <!-- Comment List -->\r\n  <CommentCard\r\n  v-for=\"(comment, i) in post.viewAll ? post.commentsList :\r\n   post.commentsList.slice(0, 1)\"\r\n  :key=\"i\"\r\n  :comment=\"comment\"\r\n  :depth=\"0\"\r\n  :current-user=\"currentUser\"\r\n  @reply-added=\"updateCommentCount\"/>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<!-- Add New Comment -->\r\n \r\n<div v-if=\"!post.commentsDisabled\" class=\"mt-4\">\r\n\r\n  <div class=\"flex gap-3 items-start\">\r\n    <img :src=\"currentUser.avatar\" class=\"w-10 h-10 rounded-full border-2 flex-shrink-0\" />\r\n\r\n    <div class=\"flex-1 relative\">\r\n      <textarea\r\n        v-model=\"post.newComment\"\r\n        placeholder=\"Write a comment...\"\r\n        class=\"w-full px-12 py-3 pr-16 text-sm bg-gray-100 rounded-2xl resize-none\r\n        focus:outline-none focus:ring-2 focus:ring-blue-400\"\r\n        rows=\"1\"\r\n        @input=\"autoResize($event)\"\r\n        @keyup.enter.exact.prevent=\"addCommentToPost(index)\">\r\n      </textarea>\r\n\r\n      <!-- Emoji Button -->\r\n      <button\r\n        class=\"absolute left-3 bottom-3 text-gray-500 hover:text-blue-500 py-2\"\r\n        @click.stop=\"toggleEmojiPicker(index)\">\r\n        <Icon icon=\"proicons:emoji\" class=\"w-5 h-5\" />\r\n      </button>\r\n\r\n      <!-- Photo Upload -->\r\n      <label \r\n      class=\"absolute right-12 bottom-3 cursor-pointer text-gray-500 hover:text-blue-500\">\r\n        <Icon icon=\"tabler:photo\" class=\"w-5 h-5\" />\r\n        <input type=\"file\" accept=\"image/*,video/*\" \r\n        class=\"hidden\" @change=\"addCommentImage($event, index)\"/>\r\n      </label>\r\n\r\n      <!-- Send Button -->\r\n      <button\r\n        v-if=\"post.newComment?.trim() || post.commentMedia?.length\"\r\n        class=\"absolute right-3 bottom-3 text-blue-500 hover:text-blue-600\"\r\n        @click=\"addCommentToPost(index)\">\r\n        <Icon icon=\"famicons:paper-plane-outline\" class=\"w-6 h-6\" />\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n\r\n\r\n\r\n  <!-- Attached Media Preview-->\r\n  <div v-if=\"post.commentMedia?.length\" class=\"mt-3 flex flex-wrap gap-2\">\r\n    <div v-for=\"(media, i) in post.commentMedia\" :key=\"i\" class=\"relative\">\r\n      <component\r\n        :is=\"media.type.startsWith('video') ? 'video' : 'img'\"\r\n        :src=\"media.url\"\r\n        class=\"w-24 h-24 object-cover rounded-lg border\"\r\n        controls />\r\n      <button\r\n        @click.stop=\"removeCommentMedia(index, i)\"\r\n        class=\"absolute top-1 right-1 bg-black/60 text-white rounded-full p-1\">\r\n        <Icon icon=\"mdi:close\" class=\"w-4 h-4\" />\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n\r\n  \r\n\r\n  <!-- Emoji Picker -->\r\n  <div v-if=\"showEmojiPickerIndex === index\" class=\"relative\">\r\n  <div class=\"absolute bottom-full right-0 mb-2 z-50\" @click.stop>\r\n  <EmojiPicker @select=\"emoji => addEmojiToComment(emoji, index)\" />\r\n  </div>\r\n  </div>\r\n\r\n\r\n</div>\r\n</div>\r\n</div>   \r\n<!--When  Post a Composer Bottom -->\r\n </main>\r\n   \r\n\r\n\r\n\r\n<!-- Right Sidebar Suggestions -->\r\n<aside class=\"w-72 bg-white border-l p-10 hidden xl:block sticky top-0 h-screen overflow-y-auto\">\r\n\r\n<!-- Profile Box with Heart Icon -->\r\n<div class=\"flex items-center justify-between mb-32\">\r\n  <div class=\"flex items-center gap-5\">\r\n  <img :src=\"currentUser.avatar\"\r\n  alt=\"Profile\"\r\n  class=\"w-16 h-16 rounded-full object-cover border-4\" />\r\n  <div>\r\n  <button @click=\"goToProfileUser\" class=\"font-medium text-blue-600 hover:text-gray-800\">\r\n  View profile\r\n  </button>\r\n    \r\n  <p class=\"text-sm text-gray-500\">{{ currentUser.name }}</p>\r\n  </div>\r\n  </div>\r\n\r\n<!-- Heart Button that redirects to Chat.vue -->\r\n<button @click=\"togglechat\" class=\"text-xl hover:text-blue-600\">\r\n<Icon\r\nicon=\"basil:comment-outline\"  class=\"w-6 h-6 transition\"/>\r\n</button>\r\n</div>\r\n\r\n<teleport to=\"body\">\r\n<transition name=\"slide-in\">\r\n<ChatPanel\r\nv-if=\"showChatPopup\" \r\n:friends=\"suggestedFriends\"\r\n:selectedUser=\"selectedUser\"\r\n@close=\"showChatPopup = false\"\r\n@friend-selected=\"handleFriendSelected\"/>\r\n</transition>\r\n</teleport>\r\n\r\n\r\n\r\n      \r\n<div class=\"flex justify-between items-center mb-12\">\r\n<h2 class=\"font-semibold text-gray-800 hover:text-blue-600 \">\r\nSuggested for you</h2>\r\n\r\n<button @click=\"ShowAll\" class=\"text-sm text-gray-500 hover:text-blue-600\" >\r\nShow All</button>\r\n</div>\r\n<ul class=\"space-y-2\">\r\n <li\r\nv-for=\"user in suggestedUsers\"\r\n :key=\"user.id\"\r\n  class=\"flex items-start gap-2 hover:bg-gray-50 p-2 rounded \">\r\n  <img\r\n  :src=\"user.avatar\"\r\n  alt=\"suggested\"\r\n  class=\"w-10 h-10 rounded-full border-2 border-purple-600\"/>\r\n  <div class=\"flex flex-col\">\r\n  <span class=\"text-sm font-medium text-gray-700\">{{ user.username }}</span>\r\n  <button \r\n  class=\"w-20 text-sm font-medium text-blue-600 py-1 \r\n  rounded hover:text-gray-700 transition duration-200\">\r\n   Follow\r\n  </button>\r\n  </div>\r\n  </li>\r\n  </ul>\r\nn\r\n<!--  Copyright Box -->\r\n<div class=\" mt-8 text-center text-xs text-gray-400\">\r\n© 2025 iFeed. All rights reserved.\r\nTeamDevOP.Sihanouk Ville City.Cambodia \r\n</div>\r\n</aside>\r\n\r\n\r\n\r\n\r\n\r\n<!-- OPEN STORY MODAL -->\r\n<div\r\n  v-if=\"activeStory\"\r\n  class=\"fixed inset-0 bg-black/80 flex items-center justify-center z-[9999]\"\r\n  @click.self=\"closeStory\">\r\n\r\n<!-- PHONE FRAME -->\r\n  <div\r\n    class=\"relative w-[90vw] max-w-[430px] aspect-[9/16]\r\n    bg-black rounded-2xl overflow-hidden shadow-2xl\">\r\n\r\n<!-- MEDIA NON INTERACTIVE) -->\r\n  \r\n<div class=\"absolute inset-0 z-0\">\r\n  <component\r\n    :is=\"activeStory.type === 'video' ? 'video' : 'img'\"\r\n    :src=\"activeStory.media\"\r\n    class=\"w-full h-full object-cover pointer-events-none\"\r\n    v-bind=\"activeStory.type === 'video'\r\n      ? { autoplay: true, muted: true, loop: true, playsinline: true }\r\n      : {}\"/>\r\n</div>\r\n\r\n\r\n    <!-- TOP OVERLAY: Avatar + Username + Time + Close -->\r\n    <div class=\"absolute inset-x-0 top-0 p-3 z-20\">\r\n      <!-- Progress Bar -->\r\n      <div class=\"h-1 w-full bg-white/20 rounded mb-3\">\r\n        <div class=\"h-full bg-white rounded\" :style=\"{ width: progress + '%' }\">\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Avatar, Username, Time -->\r\n      <div class=\"flex items-center justify-between\">\r\n        <div class=\"flex items-center gap-2 text-white\">\r\n          <!-- Avatar -->\r\n          <img\r\n            :src=\"activeStory.avatar\"\r\n            alt=\"Poster Avatar\"\r\n            class=\"w-8 h-8 rounded-full ring-2 ring-purple-500\" />\r\n          <!-- Username + Time -->\r\n          <div class=\"leading-tight\">\r\n            <p class=\"text-sm font-semibold\">{{ activeStory.username }}</p>\r\n            <p class=\"text-[11px] text-white/70\">{{ activeStory.time }}</p>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Close Button -->\r\n        <button @click=\"closeStory\" class=\"p-2 hover:bg-white/10 rounded-full\">\r\n          <Icon icon=\"material-symbols:close\" class=\"w-5 h-5 text-white\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n\r\n    <!-- CLICK ZONES (LOWER LAYER) -->\r\n    <button\r\n      @click=\"prevStory\"\r\n      class=\"absolute left-0 top-0 h-full w-1/4 z-10\">\r\n  </button>\r\n\r\n    <button\r\n      @click=\"nextStory\"\r\n      class=\"absolute right-0 top-0 h-full w-1/4 z-10\">\r\n      \r\n  </button>\r\n\r\n    <!-- LEFT ARROW (CLICKABLE) -->\r\n    <button\r\n      @click=\"prevStory\"\r\n      class=\"absolute left-3 top-1/2 -translate-y-1/2 z-40\r\n      p-2 rounded-full bg-black/30 hover:bg-black/50\">\r\n      <Icon icon=\"ooui:next-rtl\" class=\"w-6 h-6 text-white\"/>\r\n    </button>\r\n\r\n    <!-- RIGHT ARROW (CLICKABLE) -->\r\n    <button\r\n      @click=\"nextStory\"\r\n      class=\"absolute right-3 top-1/2 -translate-y-1/2 z-40\r\n      p-2 rounded-full bg-black/30 hover:bg-black/50\">\r\n    <Icon icon=\"ooui:next-ltr\" class=\"w-6 h-6 text-white\" />\r\n    </button>\r\n\r\n    <!-- BOTTOM COMPOSER -->\r\n    <div class=\"absolute inset-x-0 bottom-0 p-4 z-50\">\r\n      <div class=\"flex items-center gap-3\">\r\n        <input\r\n          v-model=\"replyText\"\r\n          type=\"text\"\r\n          placeholder=\"Send message...\"\r\n          class=\"flex-1 bg-white/90 text-[13px]\r\n                 rounded-full px-4 py-2 outline-none\"\r\n          @keydown.enter.prevent=\"sendReply\"/>\r\n\r\n<!-- Heart Button -->\r\n<button\r\n  @click=\"toggleLike\"\r\n  class=\"p-2 rounded-full hover:bg-white/20 transition-colors\">\r\n  <Icon\r\n    icon=\"solar:heart-linear\"\r\n    :class=\"[\r\n      'w-5 h-5 transition-transform transition-colors',\r\n      activeStory.liked ? 'text-red-500 scale-125' : 'text-white scale-100'\r\n    ]\"\r\n  />\r\n</button>\r\n\r\n\r\n        <button\r\n          class=\"p-2 rounded-full bg-white/10 hover:bg-white/20\"\r\n          @click=\"sendReply\">\r\n          <Icon icon=\"meteor-icons:paper-plane\" class=\"w-5 h-5 text-white\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</div>\r\n</div>\r\n  \r\n <!-- Story Modal -->\r\n\r\n</template>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<script>\r\nimport { nextTick } from 'vue';\r\nimport { Icon } from '@iconify/vue';\r\nimport EmojiPicker from 'vue3-emoji-picker';\r\nimport 'vue3-emoji-picker/css';\r\nimport CommentCard from '@/components/CommentCard.vue';\r\nimport Notify from '@/components/Notify.vue';\r\nimport ChatPanel from '@/components/ChatPanel.vue';\r\nimport story1 from '@/assets/mini.jpg';\r\nimport story2 from '@/assets/Khmer.jpg';\r\nimport story3 from '@/assets/sinayun_xyn.jpg';\r\nimport story4 from '@/assets/jena8.jpg';\r\nimport story5 from '@/assets/story2.jpg';\r\nimport sinayun from '@/assets/mini1.jpg';\r\nimport FriendSearch from '@/components/FriendSearch.vue'\r\nimport aesp from '@/assets/aesp.jpg';\r\n\r\n\r\n\r\n\r\nexport default {\r\n  name: '',\r\n  components: {\r\n    FriendSearch,\r\n    Notify,\r\n    Icon,\r\n    EmojiPicker,\r\n    CommentCard,\r\n    ChatPanel,\r\n\r\n    name: 'PostComposer',\r\n\r\n  },\r\n \r\n  data() {\r\n    return {\r\n      \r\n\r\n\r\n      \r\n      following:[], // stores userIds you follow\r\n\r\n      showSearch: false,\r\n      searchQuery: '',\r\n      showResults: false,\r\n\r\n      postLink:  null,\r\n      //Story\r\n      composerType: null, // null | 'post' | 'story'\r\n      uploadedFiles: [],\r\n\r\n\r\n      \r\n   currentUser: {\r\n      name: 'Sina Yun',\r\n      avatar: story4,\r\n      username: 'CurrentUser',\r\n      uid: null,\r\n \r\n    // Friend List for Share Post\r\n    friends: [\r\n      { id: 1, name: 'Sokha', avatar: story1 },\r\n      { id: 2, name: 'Dara', avatar: story2 },\r\n      { id: 3, name: 'Sreyneang', avatar: story3 },\r\n      { id: 4, name: 'Vannak', avatar: story4 },\r\n      { id: 5, name: 'Rithy', avatar: story5 },\r\n    ]\r\n    },\r\n      \r\n\r\n      showLikes: false,\r\n      showNotify: false,\r\n      notifications: [],\r\n      media:[], //store uplouad post\r\n      currentIndex:0,  // for slide post \r\n      newPost: '',\r\n      showEmojiPickerIndex: false,\r\n      mediaPreviews: [],\r\n      activeStory: null,\r\n      currentStoryIndex: null,\r\n      autoCloseTimer: null,\r\n      activeMenuIndex: null,\r\n      editingIndex: null,\r\n      editedCaption: '',\r\n      storyScrollRef: null,\r\n      sharePopupRefs: [],\r\n      showShareModal: false,\r\n      activeSharedPostIndex: null,\r\n\r\n      showLocation: false,\r\n      postLocation: '',\r\n      replyCommentVisible: false,\r\n      touchStartX: 0,\r\n      touchEndX: 0,\r\n      selectedMedia: null,\r\n      selectedIndex: 0,\r\n      activePostMedia: [],\r\n      activePreview: null,\r\n      scrollContainer: null,\r\n      showLocationPopup: false,\r\n      locationInput: '',\r\n      \r\n      suggestions: [\r\n      { name: 'Phnom Penh', desc: 'Cambodia' },\r\n      { name: 'Siem Reap', desc: 'Angkor Wat' },\r\n      { name: 'Kampot', desc: 'Riverside town' },                                              //Location Limit\r\n      ],\r\n\r\n\r\n      locationInputRef: null,\r\n      tags: [],\r\n      showMentionList: false,\r\n      mentionQuery: '',\r\n      filteredUsers: [],\r\n      textareaRef: null,\r\n      users: [\r\n      { name: 'sinayun' },\r\n      { name: 'nayun' },\r\n      { name: 'nita_lovekhmer' },\r\n      { name: 'chakriya' },\r\n      { name: 'konkhmer' },\r\n       { id: 1, username: 'sinayun', avatar: sinayun },\r\n\r\n  // Foller\r\n  { id: 2, username: 'nayun', avatar: story2 },\r\n  { id: 3, username: 'nita_lovekhmer', avatar: story3 },\r\n  { id: 4, username: 'chakriya', avatar: story4 },\r\n  { id: 5, username: 'konkhmer', avatar: story5 },\r\n\r\n  {\r\n    id: 'u_2',\r\n    username: 'nayun_ndo',\r\n    followers: ['u_1', 'u_4'],\r\n  },\r\n      ],\r\n     \r\n      showPostModal: false,\r\n      showChatPopup: false,\r\n      selectedUser: {},\r\n\r\n      suggestedFriends: [\r\n        { id: 1, name: 'nita_lovekhmer', time: '01:12 PM', avatar: story1 },\r\n        { id: 2, name: 'នារី_lovekhmer', time: '06:16 AM', avatar: story2 },\r\n        { id: 3, name: 'ycn_lovekhm', time: '01:12 PM', avatar: story3 },\r\n        { id: 4, name: 'Konsreypov', time: '1:12 PM', avatar: story4 },\r\n        { id: 5, name: 'Kon_Khmer', time: '1:12 PM', avatar: story5 },\r\n      ],\r\n      showSettings: false,\r\n      showRepostPopup: null, \r\n\r\n//FriendSearch\r\n\r\n      friends: [\r\n       { id: 1, username: 'Sina yun ', avatar: story1},\r\n        { id: 2, username: 'Putyhy ', avatar: story2 },\r\n        { id: 3, username: 'oun mean', avatar: story3 },\r\n        { id: 4, username: 'Yun sina', avatar: story4 },\r\n      ], \r\n        \r\n      \r\n      //Show repost \r\n      showSharePopup: null,                                                                        \r\n  \r\n      replyText: '',\r\n\r\n\r\n\r\n// Story \r\n\r\n    stories: [\r\n  { id:1, username:'nayun', avatar: sinayun, media: story1, type:'image', time:'1h ago', liked: false },\r\n  { id: 2, username: 'user_2', media: story2, type: 'video', time: '2h ago', liked: false },\r\n  { id: 3, username: 'user_3', media: story3, type: 'image', time: '3h ago', liked: false },\r\n  { id: 4, username: 'user_4', media: story4, type: 'image', time: '3h ago', liked: false },\r\n  { id: 5, username: 'user_5', media: story5, type: 'image', time: '3h ago', liked: false },\r\n  { id: 6, username: 'user_6', media: story5, type: 'image', time: '3h ago', liked: false },\r\n  { id: 7, username: 'user_1', media: story1, type: 'image', time: '1h ago', liked: false },\r\n  { id: 8, username: 'Konsreypov', media: story1, type: 'image', time: '1h ago', liked: false },\r\n],\r\n\r\n\r\n\r\n\r\n      suggestedUsers: [\r\n        { id: 1, avatar: sinayun, username: 'nita_lovekhmer' },\r\n        { id: 2, avatar: story2, username: 'នារី_lovekhmer' },\r\n        { id: 3, avatar: story3, username: 'Chakriya_konsreypov' },\r\n        { id: 4, avatar: story4, username: 'ycn_lovekhm' },\r\n        { id: 5, avatar: story5, username: 'Kon_Khmer' },     \r\n      ],\r\n\r\n      \r\n      \r\n\r\n//Post\r\n      posts: [\r\n        {\r\n          id: 1,\r\n          userId:'u_2',\r\n          user: 'nayun_ndo',\r\n          avatar: aesp,\r\n          Caption: 'Exploring the beautiful landscapes of Cambodia! #Travel #Adventure',\r\n          media: [{ url: story5, type: 'image' }],\r\n          time: '1h ago',\r\n          likes: 0,\r\n          shares: 0,\r\n          liked: false,\r\n          isFollowing: false, //Follow in post\r\n          showComments: false,\r\n          showShare: false,\r\n          newComment: '',\r\n          commentMedia: [],\r\n          commentsList: [],\r\n          commentsDisabled: false,\r\n        \r\n        },\r\n       \r\n      ],\r\n    };\r\n  },\r\n\r\n\r\n\r\n\r\n\r\n   \r\n    \r\n  \r\n\r\n//Show Result Search \r\n\r\ncomputed: {\r\n\r\n\r\n\r\n  filteredSearchUsers() {\r\n    if (!this.searchQuery) return [];\r\n    return this.users.filter(u =>\r\n      u.username.toLowerCase().includes(this.searchQuery.toLowerCase())\r\n    );\r\n  }\r\n},\r\n\r\n  \r\n\r\n  \r\n  //Method \r\n  methods: {\r\n\r\n// Open Friend Profile from Chat Panel\r\n  openProfile(index) {\r\n    console.log('Open friend profile:', index)\r\n  },\r\n\r\n \r\n\r\n\r\n    // Improved async link detection\r\n  async handlePostInput() {\r\n    // Keep any existing mention logic\r\n    this.handleMentionInput?.();\r\n\r\n    const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\r\n    const match = this.newPost.match(urlRegex);\r\n\r\n    if (match) {\r\n      const url = match[0].trim();\r\n\r\n      // Avoid re-processing the same URL\r\n      if (this.postLink?.url === url) return;\r\n\r\n      // Show loading state (optional, but nice UX)\r\n      this.postLink = { url, type: 'loading' };\r\n\r\n      const enrichedLink = await this.detectLinkType(url);\r\n      this.postLink = enrichedLink;\r\n    } else {\r\n      this.postLink = null;\r\n    }\r\n  },\r\n\r\n  async detectLinkType(url) {\r\n    // Clean trailing punctuation\r\n    let cleanUrl = url.replace(/\\.,;!?]+$/, '');\r\n\r\n    // YouTube detection\r\n    if (cleanUrl.includes('youtube.com') || cleanUrl.includes('youtu.be')) {\r\n      return { url: cleanUrl, type: 'youtube' };\r\n    }\r\n\r\n    // Use Microlink.io API — works without API key (free daily quota)\r\n    try {\r\n      const response = await fetch(`https://api.microlink.io/?url=${encodeURIComponent(cleanUrl)}`);\r\n      const data = await response.json();\r\n\r\n      if (data.data) {\r\n        const info = data.data;\r\n        return {\r\n          url: info.url || cleanUrl,\r\n          type: 'website',\r\n          title: info.title || null,\r\n          description: info.description || null,\r\n          image: info.image?.url || info.screenshot?.url || null, // fallback to screenshot if no og:image\r\n          domain: new URL(info.url || cleanUrl).hostname.replace('www.', '')\r\n        };\r\n      }\r\n    } catch (err) {\r\n      console.log('Link preview failed:', err);\r\n    }\r\n\r\n    // Final fallback\r\n    try {\r\n      const domain = new URL(cleanUrl).hostname.replace('www.', '');\r\n      return {\r\n        url: cleanUrl,\r\n        type: 'website',\r\n        title: domain.charAt(0).toUpperCase() + domain.slice(1),\r\n        description: cleanUrl,\r\n        image: null,\r\n        domain\r\n      };\r\n    } catch {\r\n      return { url: cleanUrl, type: 'website', title: 'Link', description: '', image: null, domain: 'unknown' };\r\n    }\r\n  },\r\n\r\n\r\n\r\n\r\n    //Story Add composer\r\n  \r\n    \r\n\r\n  //commment Uploaod Post\r\n \r\n addCommentImage(event, index) {\r\n  const file = event.target.files[0];\r\n  if (!file) return;\r\n\r\n  const post = this.posts[index];\r\n  if (!post.commentMedia) {\r\n    this.$set\r\n      ? this.$set(post, 'commentMedia', [])\r\n      : (post.commentMedia = []);\r\n  }\r\n\r\n  post.commentMedia.push({\r\n    url: URL.createObjectURL(file),\r\n    type: file.type\r\n  });\r\n\r\n  event.target.value = '';\r\n},\r\n\r\n\r\n\r\n getYouTubeId(url) {\r\n    const regExp = /^.*((youtu.be\\/)|(v\\/)|(u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#&?]*).*/;\r\n    const match = url.match(regExp);\r\n    return match && match[7].length === 11 ? match[7] : null;\r\n  },\r\n\r\n  handleCommentMediaUpload(event, index) {\r\n  const files = Array.from(event.target.files)\r\n  const post = this.posts[index]\r\n\r\n  // SAFETY\r\n  if (!post.commentMedia) {\r\n    this.$set(post, 'commentMedia', [])\r\n  }\r\n\r\n  files.forEach(file => {\r\n    post.commentMedia.push({\r\n      url: URL.createObjectURL(file),\r\n      type: file.type.startsWith('video') ? 'video' : 'image'\r\n    })\r\n  })\r\n\r\n  event.target.value = ''\r\n},\r\n  \r\n  //Link post \r\n//Youtube\r\n\r\n \r\n\r\n\r\n//toglle User \r\n\r\n  toggleFollowUser(userId) {\r\n  if (userId === this.currentUser.id) return;\r\n\r\n  const user = this.users.find(u => u.id === userId);\r\n  if (!user) return;\r\n\r\n  user.followers ||= [];\r\n\r\n  const i = this.following.indexOf(userId);\r\n\r\n  if (i === -1) {\r\n    this.following.push(userId);\r\n    user.followers.push(this.currentUser.id);\r\n  } else {\r\n    this.following.splice(i, 1);\r\n    user.followers = user.followers.filter(id => id !== this.currentUser.id);\r\n  }\r\n},\r\n\r\n\r\n//Comment\r\ntoggleMenu(index) {\r\n  this.activeMenuIndex =\r\n    this.activeMenuIndex === index ? null : index;\r\n},\r\n\r\n\r\n    //Follow in post\r\n    toggleFollow(index) {\r\n  const post = this.posts[index];\r\n\r\n  // prevent following yourself \r\n  if (post.user === this.currentUser.name) return;\r\n\r\n  post.isFollowing = !post.isFollowing;\r\n},\r\n\r\n     toggleSearch() {\r\n      this.showSearch = !this.showSearch\r\n    },\r\n\r\n    closeIfEmpty() {\r\n      if (!this.searchQuery) {\r\n        this.showSearch = false\r\n      }\r\n    },\r\n\r\n\r\n\r\n    handleSearch() {\r\n      console.log('Search:', this.searchQuery)\r\n    },\r\n    onSearchFocus() {\r\n  this.showResults = true;\r\n},\r\n\r\nselectSearchUser(user) {\r\n  this.searchQuery = '';\r\n  this.showResults = false;\r\n  this.showSearch = false;\r\n\r\n  // go to user profile\r\n  this.$router.push(`/profile/${user.username}`);\r\n},\r\n\r\n\r\n    //Heart Notify\r\n    listenRealtime() {\r\n      // Example: real-time push\r\n      setInterval(() => {\r\n        const newNotification = {\r\n          id: Date.now(),\r\n          userId: 3,\r\n          username: \"new_user\",\r\n          action: \"Love your post\",\r\n          time: new Date().toLocaleTimeString(),\r\n          avatar: \"\" // friend Lisdt here \r\n        };\r\n\r\n        this.notifications.unshift(newNotification);\r\n      }, 5000);\r\n    },\r\n\r\n\r\n\r\n//Notify popup\r\n   openLikesPopup() {\r\n      console.log(\"Heart clicked\"); \r\n      this.showLikes = true;\r\n  },  \r\n\r\n      goToMainfeed() {\r\n        window.location.reload();\r\n      },\r\n\r\n   goToProfileUser(){\r\n    \r\n    this.$router.push('/profile'); //Go to Profile\r\n\r\n   },\r\n\r\n\r\n   goLogin(){\r\n   localStorage.clear();\r\n   sessionStorage.clear();\r\n    this.$router.push('/'); //Go to Profile\r\n\r\n   },\r\n    handleTouchStart(e) {\r\n      this.touchStartX = e.changedTouches[0].screenX;\r\n    },\r\n    handleTouchEnd(e) {\r\n      this.touchEndX = e.changedTouches[0].screenX;\r\n      this.handleSwipe();\r\n    },\r\n    handleSwipe() {\r\n      const distance = this.touchEndX - this.touchStartX;\r\n      if (distance > 50) this.prevMedia();\r\n      if (distance < -50) this.nextMedia();\r\n    },\r\n    openMediaModal(media, mediaList) {\r\n      this.activePostMedia = mediaList;\r\n      this.selectedIndex = mediaList.findIndex((m) => m.url === media.url);\r\n      this.selectedMedia = this.activePostMedia[this.selectedIndex];\r\n    },\r\n    closeMediaModal() {\r\n      this.selectedMedia = null;\r\n      this.selectedIndex = 0;\r\n      this.activePostMedia = [];\r\n    },\r\n    nextMedia() {\r\n      if (this.selectedIndex < this.activePostMedia.length - 1) {\r\n        this.selectedIndex++;\r\n        this.selectedMedia = this.activePostMedia[this.selectedIndex];\r\n      }\r\n    },\r\n    prevMedia() {\r\n      if (this.selectedIndex > 0) {\r\n        this.selectedIndex--;\r\n        this.selectedMedia = this.activePostMedia[this.selectedIndex];\r\n      }\r\n    },\r\n    handleKeydown(e) {\r\n      if (!this.selectedMedia) return;\r\n      if (e.key === 'ArrowRight') this.nextMedia();\r\n      if (e.key === 'ArrowLeft') this.prevMedia();\r\n      if (e.key === 'Escape') this.closeMediaModal();\r\n    },\r\n    openPreview(media) {\r\n      this.activePreview = media;\r\n    },\r\n    closePreview() {\r\n      this.activePreview = null;\r\n    },\r\n\r\n\r\n\r\n    removeMedia(index) {\r\n      this.mediaPreviews.splice(index, 1);\r\n    },\r\n\r\n//Remove Comment\r\nremoveCommentMedia(postIndex, mediaIndex) {\r\n  const post = this.posts[postIndex];\r\n  if (post.commentMedia && post.commentMedia[mediaIndex]) {\r\n    URL.revokeObjectURL(post.commentMedia[mediaIndex].url);\r\n    post.commentMedia.splice(mediaIndex, 1);\r\n  }\r\n},\r\n\r\n\r\n handleFileUpload(e) {\r\n\r\n\r\n   const files = Array.from(e.target.files);\r\n\r\n  // map files to preview objects\r\n  const newFiles = files.map((file) => ({\r\n  url: URL.createObjectURL(file),\r\n  type: file.type,          // e.g., \"image/jpeg\" or \"video/mp4\"\r\n  raw: file,\r\n  name: file.name,\r\n  size: file.size\r\n  }));\r\n\r\n  // append to mediaPreviews\r\n  this.mediaPreviews.push(...newFiles);\r\n},\r\n\r\n  removeFile(index) {\r\n      URL.revokeObjectURL(this.mediaPreviews[index].url)\r\n      this.mediaPreviews.splice(index, 1)\r\n  },\r\n\r\n\r\n\r\n\r\nhandleDrop(e) {\r\n  const files = Array.from(e.dataTransfer.files);\r\n  this.mediaPreviews = files.map((file) => ({\r\n    url: URL.createObjectURL(file),\r\n    type: file.type,\r\n  }));\r\n},\r\n\r\n\r\n//Emoji Post \r\n     togglePostEmojiPicker() {\r\n      this.showPostEmojiPicker = !this.showPostEmojiPicker\r\n    },\r\n\r\n    EmojiToPost(emoji) {\r\n      this.newPost += emoji.i\r\n      this.showPostEmojiPicker = false\r\n    },\r\n\r\n\r\ntoggleEmojiPicker(index) {\r\n this.showEmojiPickerIndex = this.showEmojiPickerIndex === index ? null : index;\r\n  this.showEmojiPickerIndex === index ? null : index;\r\n},\r\n\r\n//add Emoji commet\r\naddEmojiToComment(emoji, index) {\r\n  this.showEmojiPickerIndex === index ? null : index\r\n  if (!this.posts[index].newComment) {\r\n    this.posts[index].newComment = '';\r\n  }\r\n\r\n  this.posts[index].newComment += emoji.i;\r\n  this.showEmojiPickerIndex = null;\r\n},\r\n\r\n\r\n\r\n\r\n// Submit Post \r\n  submitPost() {\r\n\r\n//Story Commposer \r\n if (!this.newPost.trim() && this.mediaPreviews.length === 0 && !this.postLink) {\r\n    alert('Please add text or media before submitting.');\r\n    return;\r\n  }\r\n\r\n  if (this.composerType === 'story') {\r\n\r\n    // STORY ONLY \r\n    this.stories.unshift({\r\n      id: Date.now(),\r\n      username: this.currentUser.username,\r\n      avatar: this.currentUser.avatar,\r\n      media: this.mediaPreviews[0]?.url || '',\r\n      type: this.mediaPreviews[0]?.type.startsWith('video') ? 'video' : 'image',\r\n      time: 'Just now',\r\n      liked: false,\r\n    });\r\n\r\n    this.$nextTick(() => {\r\n      const container = this.$refs.storyScrollRef;\r\n      if (container) container.scrollLeft = 0;\r\n    });\r\n\r\n    // Reset everything\r\n    this.resetComposer();\r\n    return; // ← VERY IMPORTANT: Stop here, don't create a post!\r\n  }\r\n\r\n  // REGULAR POST ONLY \r\n  const linkCopy = this.postLink ? { ...this.postLink } : null;\r\n\r\n  const newPostObj = {\r\n    id: Date.now(),\r\n    user: this.currentUser.name,\r\n    avatar: this.currentUser.avatar,\r\n    location: this.postLocation.trim(),\r\n    caption: this.newPost,\r\n    media: this.mediaPreviews.map(preview => ({\r\n    url: preview.url,\r\n    type: preview.type\r\n    })),\r\n    link: linkCopy,\r\n    time: 'Just now',\r\n    likes: 0,\r\n    shares: 0,\r\n    liked: false,\r\n    isFollowing: false,\r\n    showComments: false,\r\n    newComment: '',\r\n    commentMedia: [],\r\n    commentsList: [],\r\n    commentsDisabled: false,\r\n    viewAll: false,\r\n  };\r\n\r\n  this.posts.unshift(newPostObj);\r\n\r\n  // Reset\r\n  this.resetComposer();\r\n},\r\n\r\nresetComposer() {\r\n \r\n  this.newPost = '';\r\n  this.postLocation = '';\r\n  this.postLink = null;\r\n  this.composerType = null;\r\n  this.showPostModal = false;\r\n},\r\n\r\n\r\n\r\n    countTotalComments(comments) {\r\n      let count = 0;\r\n      for (const comment of comments) {\r\n        count++;\r\n        if (comment.replies?.length) {\r\n          count += this.countTotalComments(comment.replies);\r\n          \r\n        }\r\n      }\r\n      return count;\r\n    },\r\n\r\n\r\n\r\n\r\n// Toggle Like \r\n    toggleLike(index) {\r\n      const post = this.posts[index];\r\n      post.liked = !post.liked;\r\n      post.likes += post.liked ? 1 : -1;\r\n\r\n      //story like Heart\r\n      if (!this.activeStory) return;\r\n    // Toggle active story\r\n    this.activeStory.liked = !this.activeStory.liked;\r\n\r\n    // Optional update the main stories array to persist\r\n    this.stories[this.currentStoryIndex].liked = this.activeStory.liked;\r\n    },\r\n\r\n\r\n    toggleSharePopup(index) {\r\n      this.posts[index].showShare = !this.posts[index].showShare;\r\n    },\r\n\r\n    addCommentToPost(index) {\r\n      const post = this.posts[index];\r\n      const text = post.newComment.trim();\r\n      if (!text) return;\r\n      if (!Array.isArray(post.commentsList)) post.commentsList = [];\r\n      if (!Array.isArray(post.commentMedia)) post.commentMedia = [];\r\n\r\n      post.commentsList.push({\r\n        user: this.currentUser.name,\r\n        avatar: this.currentUser.avatar || this.defaultAvatar,\r\n        text,\r\n        media: [...post.commentMedia],\r\n        time:'Just now',\r\n        liked: false,\r\n        replies: [],\r\n      });\r\n      post.newComment = '';\r\n      post.commentMedia = []; //Preview imgae\r\n    },\r\n    autoResize(event) {\r\n      const el = event.target;\r\n      el.style.height = 'auto';\r\n      el.style.height = el.scrollHeight + 'px';\r\n    },\r\n\r\n\r\n  //Location\r\n    getLocation() {\r\n      this.showLocationPopup = true;\r\n      if (navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition(\r\n          (pos) => {\r\n            const { latitude, longitude } = pos.coords;\r\n            fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`)\r\n              .then((res) => res.json())\r\n              .then((data) => {\r\n                this.locationInput =\r\n                  data.address.city ||\r\n                  data.address.town ||\r\n                  data.address.village ||\r\n                  'Unknown';\r\n              })\r\n              .catch((err) => {\r\n                this.locationInput = 'Location error';\r\n                console.error(err);\r\n              });\r\n          },\r\n          (error) => {\r\n            console.error('Geolocation error:', error.message);\r\n            this.locationInput = 'Permission denied';\r\n          }\r\n        );\r\n      } else {\r\n        this.locationInput = 'Geolocation not supported';\r\n      }\r\n    },\r\n    confirmLocation() {\r\n      this.postLocation = this.locationInput;\r\n      this.showLocationPopup = false;\r\n      this.locationInput = '';\r\n    },\r\n    closeLocation() {\r\n      this.showLocationPopup = false;\r\n    },\r\n    pickSuggestion(s) {\r\n      this.locationInput = s.name;\r\n      this.confirmLocation();\r\n    },\r\n    formatCount(num) {\r\n      if (num >= 1000000000) return (num / 1000000000).toFixed(1) + 'B';\r\n      if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';\r\n      if (num >= 1000) return (num / 1000).toFixed(1) + 'K';\r\n      return num.toString();\r\n    },\r\n    updateCommentCount() {\r\n      console.log('Reply added!');\r\n    },\r\n\r\n\r\ntoggleCommentSection(index) {\r\n    this.posts[index].showComments = !this.posts[index].showComments;\r\n\r\n  // close menu if open\r\n  this.activeMenuIndex = null;\r\n},\r\n\r\n\r\ntoggleComment(index) {\r\n  this.posts[index].commentsDisabled =\r\n  !this.posts[index].commentsDisabled;\r\n\r\n  this.activeMenuIndex = null; // close menu\r\n},\r\n\r\n    confirmDelete(index) {\r\n      this.posts.splice(index, 1);\r\n      this.activeMenuIndex = null;\r\n    },\r\n    startEditPost(index) {\r\n      this.editingIndex = index;\r\n      this.editedCaption = this.posts[index].caption;\r\n      this.activeMenuIndex = null;\r\n    },\r\n    saveEditedPost(index) {\r\n      this.posts[index].caption = this.editedCaption;\r\n      this.editingIndex = null;\r\n    },\r\n    cancelEdit() {\r\n      this.editingIndex = null;\r\n    },\r\n\r\n\r\n\r\n\r\n     // Scrolling Story Next icon \r\n     scrollStories(direction) {\r\n    const el = this.$refs.storyScrollRef;\r\n    if (!el) return;\r\n\r\n    const scrollAmount = 120; // width of one story card\r\n\r\n    if (direction === 'left') {\r\n      el.scrollBy({ left: -scrollAmount, behavior: 'smooth' });\r\n    } else {\r\n      el.scrollBy({ left: scrollAmount, behavior: 'smooth' });\r\n    }\r\n  },\r\n\r\n  //Story  Disable arrows at edges \r\n    canScrollLeft() {\r\n    const el = this.$refs.storyScrollRef;\r\n    return el && el.scrollLeft > 0;\r\n  },\r\n  canScrollRight() {\r\n    const el = this.$refs.storyScrollRef;\r\n    return el && el.scrollLeft + el.clientWidth < el.scrollWidth;\r\n  },\r\n\r\n\r\n\r\n\r\n    //Story open\r\n    openStory(index) {\r\n      this.currentStoryIndex = index;\r\n      this.activeStory = this.stories[index];\r\n      this.activeStory = this.stories[index];\r\n    this.progress = 0; // reset progress\r\n    },\r\n\r\n    //Story close\r\n    closeStory() {\r\n      this.activeStory = null;\r\n      clearTimeout(this.autoCloseTimer);\r\n      this.progress = 0;\r\n    },\r\n    \r\n    //Story next\r\n    nextStory() {\r\n      if (this.currentStoryIndex < this.stories.length - 1) {\r\n        this.openStory(this.currentStoryIndex + 1);\r\n      } else {\r\n        this.closeStory();\r\n      }\r\n    },\r\n\r\n    //Story pre\r\n    prevStory() {\r\n      if (this.currentStoryIndex > 0) {\r\n        this.openStory(this.currentStoryIndex - 1);\r\n      }\r\n    },\r\n\r\n    //Sotry\r\n    sendReply() {\r\n      const text = this.replyText.trim();\r\n      if (!text) return;\r\n      this.replyText = '';\r\n    },\r\n\r\n\r\n\r\n\r\n\r\n    copyLink() {\r\n      navigator.clipboard.writeText(window.location.href).then(() => {\r\n        alert('Link copied to ');\r\n      });\r\n    },\r\n    shareToFacebook() {\r\n      const url = encodeURIComponent(window.location.href);\r\n      const fbUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;\r\n      window.open(fbUrl, '_blank', 'width=600,height=600');\r\n    },\r\n    shareToTelegram() {\r\n      const url = encodeURIComponent(window.location.href);\r\n      const tgUrl = `https://t.me/share/url?url=${url}`;\r\n      window.open(tgUrl, '_blank', 'width=600,height=600');\r\n    },\r\n    shareToMessenger() {\r\n      const url = encodeURIComponent(window.location.href);\r\n      const appId = 'FACEBOOK_APP_ID';\r\n      const msgUrl = `https://www.messenger.com/dialog/send?link=${url}&app_id=${appId}&redirect_uri=${url}`;\r\n      window.open(msgUrl, '_blank', 'width=600,height=600');\r\n    },\r\n\r\n\r\n  // Outside Click\r\n   handleClickOutside(event) {\r\n      const wrapper = this.$refs.emojiWrapper;\r\n      if (wrapper && !wrapper.contains(event.target)) {\r\n        this.showEmojiPickerIndex = false;\r\n      }\r\n    },\r\n\r\n\r\n    handleOutsideClick(event) {\r\n    // Close Emoji Picker\r\n    const emojiPickers = this.$refs.emojiPickerRefs || [];\r\n    if (!emojiPickers.some(ref => ref.contains(event.target))) {\r\n      this.showEmojiPickerIndex = false;\r\n    }\r\n\r\n    // Close Post Menu\r\n    const menus = this.$refs.postMenuRefs || [];\r\n    if (!menus.some(ref => ref.contains(event.target))) {\r\n      this.activeMenuIndex = null;\r\n    }\r\n\r\n    // Close Settings\r\n    const settings = this.$refs.settingsRef;\r\n    if (settings && !settings.contains(event.target)) {\r\n      this.showSettings = false;\r\n    }\r\n\r\n    // Close Share Popup\r\n    const sharePopup = this.$refs.sharePopupRef;\r\n    if (sharePopup && !sharePopup.contains(event.target)) {\r\n      this.showShareModal = false;\r\n    }\r\n  },\r\n\r\n    \r\n    OffComment(index) {\r\n      this.posts[index].commentsDisabled = true;\r\n      this.activeMenuIndex = null;\r\n    },\r\n    copylink(index) {\r\n      const postId = this.posts[index].id;\r\n      const postUrl = `${window.location.origin}/post/${postId}`;\r\n      navigator.clipboard.writeText(postUrl).then(() => {\r\n        alert('Link copied!');\r\n      });\r\n    },\r\n    shareTo(index) {\r\n      this.activeSharedPostIndex = index;\r\n      this.showShareModal = true;\r\n    },\r\n    toggleReplyComment() {\r\n      this.replyCommentVisible = !this.replyCommentVisible;\r\n    },\r\n    handleInput(e) {\r\n      const cursorPos = e.target.selectionStart;\r\n      const textUpToCursor = this.newPost.substring(0, cursorPos);\r\n      const mentionMatch = textUpToCursor.match(/@(\\w*)$/);\r\n      if (mentionMatch) {\r\n        this.mentionQuery = mentionMatch[1].toLowerCase();\r\n        this.filteredUsers = this.users.filter((user) =>\r\n          user.name.toLowerCase().startsWith(this.mentionQuery)\r\n        );\r\n        this.showMentionList = this.filteredUsers.length > 0;\r\n      } else {\r\n        this.showMentionList = false;\r\n      }\r\n    },\r\n    selectMention(username) {\r\n      nextTick(() => {\r\n        const textarea = this.textareaRef;\r\n        if (!textarea) return;\r\n        const cursorPos = textarea.selectionStart;\r\n        const textBeforeCursor = this.newPost.substring(0, cursorPos);\r\n        const textAfterCursor = this.newPost.substring(cursorPos);\r\n        const newTextBeforeCursor = textBeforeCursor.replace(/@\\w*$/, '@' + username + ' ');\r\n        this.newPost = newTextBeforeCursor + textAfterCursor;\r\n        nextTick(() => {\r\n          textarea.selectionStart = textarea.selectionEnd = newTextBeforeCursor.length;\r\n          textarea.focus();\r\n        });\r\n        this.showMentionList = false;\r\n      });\r\n    },\r\n  \r\n    switchTab(tab) {\r\n      this.activeTab = tab;\r\n    },\r\n\r\n\r\n    openPostModal() {\r\n        //Story\r\n      this.composerType = null\r\n      this.uploadedFiles = [],\r\n       this.showPostModal = true\r\n      this.composerType = null\r\n      this.newPost = ''\r\n      this.mediaPreviews = []\r\n      \r\n      //\r\n\r\n      this.showPostModal = true;\r\n      nextTick(() => {\r\n        const textarea = document.querySelector('textarea[placeholder=\"What\\'s on your mind?\"]');\r\n        textarea?.focus();\r\n      });\r\n    },\r\n\r\n    \r\n    closePostModal() {\r\n  // Revoke only on cancel\r\n  this.mediaPreviews.forEach(preview => URL.revokeObjectURL(preview.url));\r\n  this.mediaPreviews = [];\r\n  this.newPost = '';\r\n  this.postLocation = '';\r\n  this.postLink = null;\r\n  this.composerType = null;\r\n  this.showPostModal = false;\r\n  \r\n    },\r\n//FriensSearch\r\n handleAddFriend(user) {\r\n      console.log('Add friend:', user)\r\n },\r\n\r\n    handleFriendSelected(friend) {\r\n      this.selectedUser = friend;\r\n    },\r\n    togglechat() {\r\n      this.showChatPopup = !this.showChatPopup;\r\n    },\r\n    toggleSettings() {\r\n      this.showSettings = !this.showSettings;\r\n    },\r\n    closePopup() {\r\n      this.showRepostPopup = false;\r\n    },\r\n  },\r\n\r\n\r\n\r\n  watch: {\r\n    newPost(newVal, oldVal) {\r\n    //  URL \r\n    if (newVal !== oldVal) {\r\n      this.handlePostInput();\r\n    }\r\n  },\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    selectedMedia(newVal) {\r\n      if (newVal) {\r\n        window.addEventListener('keydown', this.handleKeydown);\r\n      } else {\r\n        window.removeEventListener('keydown', this.handleKeydown);\r\n      }\r\n    },\r\n    activeStory(story) {\r\n      clearTimeout(this.autoCloseTimer);\r\n      if (story) {\r\n        this.autoCloseTimer = setTimeout(() => {\r\n          this.nextStory();\r\n        }, 5000);\r\n      }\r\n    },\r\n    showLocationPopup(on) {\r\n      if (on) {\r\n        nextTick(() => {\r\n          this.locationInputRef?.focus();\r\n        });\r\n      }\r\n    },\r\n  },\r\n\r\n\r\n\r\n  mounted() {\r\n\r\n\r\n    //Get the Google/Email data from storage\r\n    const storedName = localStorage.getItem('userDisplayName');\r\n    const storedAvatar = localStorage.getItem('userAvatar');\r\n    const storedUserData = localStorage.getItem('newUserData');\r\n\r\n\r\n    if (storedName) {\r\n      this.currentUser.name = storedName;\r\n    } else if (storedUserData) {\r\n      try {\r\n        const parsed = JSON.parse(storedUserData);\r\n        this.currentUser.name = `${parsed.firstName} ${parsed.lastName}`;\r\n      } catch (e) {\r\n        console.error(\"Error parsing user data\", e);\r\n      }\r\n    }\r\n\r\n    // 3. Set Avatar if it exists in storage (Gmail URL)\r\n    if (storedAvatar && storedAvatar !== 'null' && storedAvatar !== 'undefined') {\r\n      this.currentUser.avatar = storedAvatar;\r\n    }\r\n\r\n\r\n\r\n\r\n    // this.listenRealtime();\r\n    document.addEventListener('click', this.handleClickOutside);\r\n    this.posts = this.posts.map((post) => ({\r\n      ...post,\r\n      liked: false,\r\n      isFollowing:false, //Follow post\r\n      showComments: false,\r\n      showShare: false,\r\n      \r\n      newComment: '',\r\n      commentsList: post.commentsList || [],\r\n      commentMedia: post.commentMedia || [],\r\n      viewAll: false,\r\n    }));\r\n  },\r\n  unmounted() {\r\n    document.removeEventListener('click', this.handleOutsideClick);\r\n    clearTimeout(this.autoCloseTimer);\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<style scoped>\r\n/* Hide scrollbar for all browsers */\r\n.no-scrollbar::-webkit-scrollbar {\r\n  display: none;\r\n}\r\n.no-scrollbar {\r\n  -ms-overflow-style: none;\r\n  scrollbar-width: none;\r\n}\r\n\r\n/*comment css*/\r\ntextarea {\r\n  overflow: hidden;\r\n  resize: none;\r\n}ម\r\n\r\n/*PopupChat*/\r\n.slide-in-enter-active {\r\n  transition: transform 0.3s ease;\r\n}\r\n.slide-in-leave-active {\r\n  transition: transform 0.3s ease;\r\n}\r\n.slide-in-enter-from {\r\n  transform: translateX(100%);\r\n}\r\n.slide-in-leave-to {\r\n  transform: translateX(100%);\r\n}\r\n/* Smooth textarea height animation */\r\ntextarea {\r\n  transition: all 0.2s ease;\r\n  min-height: 44px;\r\n  max-height: 120px;\r\n  overflow-y: auto !important;\r\n}\r\n\r\n/* Hide scrollbar but keep functionality */\r\ntextarea::-webkit-scrollbar {\r\n  display: none;\r\n}\r\ntextarea {\r\n  -ms-overflow-style: none;\r\n  scrollbar-width: none;\r\n}\r\n\r\n\r\n\r\n</style>                  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}