{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array-buffer.detached.js\";\nimport \"core-js/modules/es.array-buffer.transfer.js\";\nimport \"core-js/modules/es.array-buffer.transfer-to-fixed-length.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { computed } from 'vue';\nimport { ref, nextTick } from 'vue';\nimport { Icon } from '@iconify/vue';\nimport EmojiPicker from 'vue3-emoji-picker';\nimport 'vue3-emoji-picker/css';\nimport sinayun from '@/assets/jeny3.jpg';\nimport story1 from '@/assets/story1.jpg';\nimport story2 from '@/assets/story2.jpg';\nimport story3 from '@/assets/story3.jpg';\nimport story4 from '@/assets/story4.jpg';\nimport story5 from '@/assets/story5.jpg';\n\n// States\n\nexport default {\n  __name: 'ChatPanel',\n  props: {\n    currentUser: Object,\n    friends: Array\n  },\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const props = __props;\n    const searchQuery = ref('');\n    const chatStarted = ref(false);\n    const selectedUser = ref(null);\n    const filteredFriends = computed(() => {\n      return props.friends.filter(friend => friend.name.toLowerCase().includes(searchQuery.value.toLowerCase()));\n    });\n    function selectFriend(friend) {\n      selectedUser.value = friend;\n      chatStarted.value = true;\n    }\n    const newMessage = ref('');\n    const showEmojiPicker = ref(false);\n    const messages = ref([]);\n    const currentUser = ref({\n      name: 'sinayun_xyn',\n      role: 'Software Engineering',\n      avatar: sinayun\n    });\n\n    // Friend List\n    const friends = [{\n      id: 1,\n      name: 'nita_lovekhmer',\n      time: '01:12 PM',\n      avatar: story1\n    }, {\n      id: 2,\n      name: 'áž“áž¶ážšáž¸_lovekhmer',\n      time: '06:16 AM',\n      avatar: story2\n    }, {\n      id: 3,\n      name: 'ycn_lovekhm',\n      time: '01:12 PM',\n      avatar: story3\n    }, {\n      id: 4,\n      name: 'Konsreypov',\n      time: '1:12 PM',\n      avatar: story4\n    }, {\n      id: 5,\n      name: 'Kon_Khmer',\n      time: '1:12 PM',\n      avatar: story5\n    }];\n\n    // Send message\n    function sendMessage() {\n      if (newMessage.value.trim()) {\n        const now = new Date();\n        const time = now.toLocaleTimeString([], {\n          hour: '2-digit',\n          minute: '2-digit'\n        });\n        messages.value.push({\n          text: newMessage.value.trim(),\n          from: 'me',\n          user: currentUser.value.name,\n          avatar: currentUser.value.avatar,\n          time,\n          date: getFormattedDate(now)\n        });\n        newMessage.value = '';\n        scrollToBottomSmart();\n\n        // Remove bot reply completely\n      }\n    }\n\n    // Emoji picker\n    function toggleEmojiPicker() {\n      showEmojiPicker.value = !showEmojiPicker.value;\n    }\n    function addEmoji(emoji) {\n      newMessage.value += emoji.i;\n    }\n\n    // Format Date\n    function getFormattedDate(date) {\n      return date.toLocaleDateString('en-GB'); // Change format as needed\n    }\n\n    // Scroll to bottom smoothly\n    function scrollToBottomSmart() {\n      nextTick(() => {\n        const chatContainer = document.querySelector('.flex-1.overflow-y-auto');\n        if (chatContainer) {\n          chatContainer.scrollTop = chatContainer.scrollHeight;\n        }\n      });\n    }\n\n    // File handlers (optional)\n    function handleMediaUpload(e) {\n      const files = Array.from(e.target.files);\n      if (!files.length) return;\n      files.forEach(file => {\n        const reader = new FileReader();\n        reader.onload = () => {\n          const now = new Date();\n          const isVideo = file.type.startsWith('video');\n          messages.value.push({\n            from: 'me',\n            avatar: currentUser.value.avatar,\n            time: now.toLocaleTimeString([], {\n              hour: '2-digit',\n              minute: '2-digit'\n            }),\n            [isVideo ? 'video' : 'image']: reader.result\n          });\n          scrollToBottomSmart();\n        };\n        reader.readAsDataURL(file);\n      });\n    }\n    const mediaPreview = ref(null);\n    function openMediaPreview(src) {\n      mediaPreview.value = src;\n    }\n    function deleteMessage(index) {\n      messages.value.splice(index, 1);\n    }\n\n    //Paper Clip\n    const fileInput = ref(null);\n    function triggerFileInput() {\n      fileInput.value?.click();\n    }\n    function handleFileUpload(e) {\n      const file = e.target.files[0];\n      if (!file) return;\n      const now = new Date();\n      const url = URL.createObjectURL(file);\n      messages.value.push({\n        from: 'me',\n        avatar: currentUser.value.avatar,\n        file: {\n          name: file.name,\n          type: file.type,\n          url\n        },\n        time: now.toLocaleTimeString([], {\n          hour: '2-digit',\n          minute: '2-digit'\n        })\n      });\n    }\n\n    //Mic \n    const recordingTimer = ref(0); // Timer in seconds\n\n    const recordingTimerDisplay = computed(() => {\n      const min = String(Math.floor(recordingTimer.value / 60)).padStart(2, '0');\n      const sec = String(recordingTimer.value % 60).padStart(2, '0');\n      return `${min}:${sec}`;\n    });\n    const isRecording = ref(false);\n    let mediaRecorder = null;\n    let audioChunks = [];\n    let timerInterval = null;\n    let audioContext = null;\n    let analyser = null;\n    let animationId = null;\n    function toggleRecording() {\n      if (isRecording.value) {\n        stopRecording();\n      } else {\n        startRecording();\n      }\n    }\n    function startRecording() {\n      navigator.mediaDevices.getUserMedia({\n        audio: true\n      }).then(stream => {\n        mediaRecorder = new MediaRecorder(stream);\n        audioChunks = [];\n        mediaRecorder.ondataavailable = e => audioChunks.push(e.data);\n        mediaRecorder.onstop = () => {\n          clearInterval(timerInterval);\n          cleanupAudioVisualizer();\n          if (!audioChunks.length) return;\n          const blob = new Blob(audioChunks, {\n            type: 'audio/webm'\n          });\n          const url = URL.createObjectURL(blob);\n          messages.value.push({\n            from: 'me',\n            avatar: currentUser.value.avatar,\n            audio: url,\n            time: new Date().toLocaleTimeString([], {\n              hour: '2-digit',\n              minute: '2-digit'\n            })\n          });\n        };\n        mediaRecorder.start();\n        isRecording.value = true;\n        recordingTimer.value = 0;\n\n        // âœ… This line fixes the warning and activates the waveform\n        startWaveformVisualizer(stream);\n        timerInterval = setInterval(() => {\n          recordingTimer.value++;\n        }, 1000);\n      });\n    }\n    function stopRecording() {\n      if (mediaRecorder && isRecording.value) {\n        mediaRecorder.stop();\n        isRecording.value = false;\n        clearInterval(timerInterval);\n      }\n    }\n\n    //Touch Audio\n    const touchStartX = ref(0);\n    const touchEndX = ref(0);\n    function onTouchStart(e) {\n      touchStartX.value = e.touches[0].clientX;\n    }\n    function onTouchMove(e) {\n      touchEndX.value = e.touches[0].clientX;\n    }\n    function onTouchEnd(index) {\n      const distance = touchStartX.value - touchEndX.value;\n      if (distance > 80) {\n        // Swipe left = delete audio\n        messages.value.splice(index, 1);\n      }\n    }\n\n    //Wave voice\n    const waveformData = ref(new Array(80).fill(4)); // 80 bars at 4px height\n\n    // ðŸŽ¤ Start mic visualizer\n    function startWaveformVisualizer(stream) {\n      audioContext = new (window.AudioContext || window.webkitAudioContext)();\n      const source = audioContext.createMediaStreamSource(stream);\n      analyser = audioContext.createAnalyser();\n      analyser.fftSize = 64;\n      source.connect(analyser);\n      const bufferLength = analyser.frequencyBinCount;\n      const dataArray = new Uint8Array(bufferLength);\n      const render = () => {\n        analyser.getByteFrequencyData(dataArray);\n        waveformData.value = dataArray.slice(0, waveformData.value.length).map(v => Math.max(4, v / 255 * 28)); // scale height smoothly\n\n        animationId = requestAnimationFrame(render);\n      };\n      render();\n    }\n\n    // ðŸ§¼ Stop mic visualizer\n    function cleanupAudioVisualizer() {\n      cancelAnimationFrame(animationId);\n      if (audioContext) {\n        audioContext.close();\n        audioContext = null;\n      }\n      waveformData.value = new Array(80).fill(4);\n    }\n\n    //Swipe Audio\n    function swipeTranslateX() {\n      const distance = touchStartX.value - touchEndX.value;\n      return distance > 0 ? `translateX(-${Math.min(distance, 100)}px)` : '';\n    }\n\n    // Forward  massage\n    const forwardingMessage = ref(null);\n    function forwardMessage(msg) {\n      forwardingMessage.value = msg;\n    }\n    function sendForwardTo(friend) {\n      const now = new Date();\n      const forwarded = {\n        ...forwardingMessage.value,\n        time: now.toLocaleTimeString([], {\n          hour: '2-digit',\n          minute: '2-digit'\n        })\n      };\n\n      // simulate message going to another user\n      messages.value.push({\n        ...forwarded,\n        from: 'me',\n        forwardedTo: friend.name\n      });\n      forwardingMessage.value = null;\n    }\n\n    // Auto row\n\n    const autoResize = e => {\n      const el = e.target;\n      el.style.height = 'auto';\n      el.style.height = el.scrollHeight + 'px';\n    };\n\n    //\n\n    const __returned__ = {\n      props,\n      searchQuery,\n      chatStarted,\n      selectedUser,\n      filteredFriends,\n      selectFriend,\n      newMessage,\n      showEmojiPicker,\n      messages,\n      currentUser,\n      friends,\n      sendMessage,\n      toggleEmojiPicker,\n      addEmoji,\n      getFormattedDate,\n      scrollToBottomSmart,\n      handleMediaUpload,\n      mediaPreview,\n      openMediaPreview,\n      deleteMessage,\n      fileInput,\n      triggerFileInput,\n      handleFileUpload,\n      recordingTimer,\n      recordingTimerDisplay,\n      isRecording,\n      get mediaRecorder() {\n        return mediaRecorder;\n      },\n      set mediaRecorder(v) {\n        mediaRecorder = v;\n      },\n      get audioChunks() {\n        return audioChunks;\n      },\n      set audioChunks(v) {\n        audioChunks = v;\n      },\n      get timerInterval() {\n        return timerInterval;\n      },\n      set timerInterval(v) {\n        timerInterval = v;\n      },\n      get audioContext() {\n        return audioContext;\n      },\n      set audioContext(v) {\n        audioContext = v;\n      },\n      get analyser() {\n        return analyser;\n      },\n      set analyser(v) {\n        analyser = v;\n      },\n      get animationId() {\n        return animationId;\n      },\n      set animationId(v) {\n        animationId = v;\n      },\n      toggleRecording,\n      startRecording,\n      stopRecording,\n      touchStartX,\n      touchEndX,\n      onTouchStart,\n      onTouchMove,\n      onTouchEnd,\n      waveformData,\n      startWaveformVisualizer,\n      cleanupAudioVisualizer,\n      swipeTranslateX,\n      forwardingMessage,\n      forwardMessage,\n      sendForwardTo,\n      autoResize,\n      computed,\n      ref,\n      nextTick,\n      get Icon() {\n        return Icon;\n      },\n      get EmojiPicker() {\n        return EmojiPicker;\n      },\n      get sinayun() {\n        return sinayun;\n      },\n      get story1() {\n        return story1;\n      },\n      get story2() {\n        return story2;\n      },\n      get story3() {\n        return story3;\n      },\n      get story4() {\n        return story4;\n      },\n      get story5() {\n        return story5;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","ref","nextTick","Icon","EmojiPicker","sinayun","story1","story2","story3","story4","story5","props","__props","searchQuery","chatStarted","selectedUser","filteredFriends","friends","filter","friend","name","toLowerCase","includes","value","selectFriend","newMessage","showEmojiPicker","messages","currentUser","role","avatar","id","time","sendMessage","trim","now","Date","toLocaleTimeString","hour","minute","push","text","from","user","date","getFormattedDate","scrollToBottomSmart","toggleEmojiPicker","addEmoji","emoji","i","toLocaleDateString","chatContainer","document","querySelector","scrollTop","scrollHeight","handleMediaUpload","e","files","Array","target","length","forEach","file","reader","FileReader","onload","isVideo","type","startsWith","result","readAsDataURL","mediaPreview","openMediaPreview","src","deleteMessage","index","splice","fileInput","triggerFileInput","click","handleFileUpload","url","URL","createObjectURL","recordingTimer","recordingTimerDisplay","min","String","Math","floor","padStart","sec","isRecording","mediaRecorder","audioChunks","timerInterval","audioContext","analyser","animationId","toggleRecording","stopRecording","startRecording","navigator","mediaDevices","getUserMedia","audio","then","stream","MediaRecorder","ondataavailable","data","onstop","clearInterval","cleanupAudioVisualizer","blob","Blob","start","startWaveformVisualizer","setInterval","stop","touchStartX","touchEndX","onTouchStart","touches","clientX","onTouchMove","onTouchEnd","distance","waveformData","fill","window","AudioContext","webkitAudioContext","source","createMediaStreamSource","createAnalyser","fftSize","connect","bufferLength","frequencyBinCount","dataArray","Uint8Array","render","getByteFrequencyData","slice","map","v","max","requestAnimationFrame","cancelAnimationFrame","close","swipeTranslateX","forwardingMessage","forwardMessage","msg","sendForwardTo","forwarded","forwardedTo","autoResize","el","style","height"],"sources":["D:/login-feed/src/components/ChatPanel.vue"],"sourcesContent":["<template>\r\n <div class=\"fixed top-0 right-0 h-full w-[400px] bg-white shadow-xl border-l border-gray-200 z-[9999] flex flex-col\">\r\n    <!-- Header -->\r\n    <div class=\"flex justify-between items-center p-4 border-b\">\r\n    <button @click=\"$emit('close')\" class=\"text-gray-400 hover:text-black\">close</button>\r\n    </div>\r\n\r\n<!-- Current User -->\r\n<div class=\"flex items-center gap-5 mb-5 px-5\">\r\n<img :src=\"currentUser.avatar\" class=\"w-10 h-10 rounded-full border-2 border-purple-600\" />\r\n<div>\r\n <p class=\"font-semibold text-sm\">{{ currentUser.name }}</p>\r\n <p class=\"text-xs text-gray-400\">{{ currentUser.role }}</p>\r\n</div>\r\n</div>\r\n\r\n<!-- Search Bar -->\r\n<div class=\"relative mb-5 px-5\">\r\n<input\r\nv-model=\"searchQuery\"\r\ntype=\"text\"\r\nplaceholder=\"Search Friend...\"\r\nclass=\"w-full border border-gray-300 rounded-full px-4 py-2 pl-10 text-sm focus:outline-none focus:ring-1 \"/>\r\n<Icon icon=\"mdi:magnify\" class=\"absolute left-7 top-2.5 text-gray-400 w-4 h-4\" />\r\n</div>\r\n\r\n<!-- FRIEND LIST or CHAT THREAD VIEW --> \r\n  <div v-if=\"!chatStarted\" class=\"space-y-3 overflow-y-auto px-4\">\r\n  <div\r\n  v-for=\"friend in filteredFriends\"\r\n  :key=\"friend.id\"\r\n  class=\"flex items-center justify-between hover:bg-gray-50 px-2 py-1 rounded cursor-pointer\"\r\n  @click=\"selectFriend(friend)\">\r\n  <div class=\"flex items-center gap-2\">\r\n  <img :src=\"friend.avatar\" class=\"w-8 h-8 rounded-full border-2 border-purple-600\" />\r\n  <span class=\"text-sm font-medium text-blue-700\">{{ friend.name }}</span>\r\n  </div>\r\n  <span class=\"text-xs text-gray-500\">{{ friends.time }}</span>\r\n  </div>\r\n  </div>\r\n\r\n<!-- CHAT THREAD VIEW -->\r\n  <div v-else class=\"flex flex-col flex-1 overflow-hidden\">\r\n  <!-- Chat Header -->\r\n  <div class=\"border-b px-6 py-4 bg-white flex items-center justify-between\">\r\n  <div class=\"flex items-center gap-3\">\r\n  <img :src=\"selectedUser.avatar\" class=\"w-10 h-10 rounded-full\" />\r\n  <div>\r\n  <h2 class=\"font-semibold\">{{ selectedUser.name }}</h2>\r\n <p class=\"text-xs text-green-500\">{{ selectedUser.status ||'online' }}</p>\r\n </div>\r\n </div>\r\n\r\n <button @click=\"chatStarted = false\" class=\"text-gray-400 hover:text-black\">\r\n<Icon icon=\"ci:chevron-left\"/>\r\n</button>\r\n <button>\r\n  <Icon icon=\"material-symbols:zoom-out-map-rounded\"/>\r\n </button>\r\n </div>\r\n\r\n\r\n\r\n\r\n<!-- Message + Input -->\r\n<div class=\"flex flex flex-col h-full overflow-hidden\">\r\n\r\n<!-- Messages Wrap Here -->\r\n<div class=\"flex-1 overflow-y-auto px-4 py-4 space-y-4 gap-2\">\r\n<div\r\nv-for=\"(msg, index) in messages\"\r\n:key=\"index\"\r\nclass=\"flex items-end gap-1\"\r\n:class=\"msg.from === 'me' ? 'justify-end' : 'justify-start'\">\r\n<!-- Avatar -->\r\n   <img\r\n      :src=\"msg.avatar\"\r\n      class=\"w-8 h-8 rounded-full gap-1\"\r\n      :class=\"msg.from === 'me' ? 'order-2' : 'order-1'\"/>\r\n\r\n<!-- Message Bubble -->\r\n<div\r\nclass=\"max-w-[70%] flex flex-col gap-1\"\r\n :class=\"msg.from === 'me' ? 'items-end order-1' : 'items-start order-2'\">\r\n\r\n <!-- File Message -->\r\n <div\r\n v-if=\"msg.file\"\r\n class=\"flex items-center gap-2 bg-gray-100 px-3 py-2 rounded-lg\">\r\n<Icon icon=\"iconamoon:file-document-thin\" class=\"text-blue-600 w-5 h-5\" />\r\n<a\r\n target=\"_blank\"\r\n class=\"text-sm font-medium text-blue-700 underline\">{{ msg.file.name }}\r\n</a>\r\n</div>\r\n\r\n\r\n<!-- Audio Message -->\r\n<div\r\n  v-if=\"msg.audio\"\r\n  class=\"flex flex-col transition-transform duration-200 max-w-[70%] \"\r\n  :style=\"{ transform: swipeTranslateX(index) }\"\r\n  :class=\"msg.from === 'me' ? ' items-end self-end' : 'items-start self-start '\" \r\n  @touchstart=\"onTouchStart\"\r\n  @touchmove=\"onTouchMove\"\r\n  @touchend=\"onTouchEnd(index)\">\r\n\r\n  \r\n  <!-- Audio Bubble Container -->\r\n  <div\r\n    class=\"rounded-2xl px-3 py-2 flex flex-col gap-2\"\r\n    :class=\"msg.from === 'me' ? 'text-white' : 'text-white'\">\r\n    <audio\r\n      :src=\"msg.audio \"\r\n      \r\n      controls\r\n      class=\"w-56 \" >\r\n  </audio>\r\n\r\n    <!-- Optional text below audio -->\r\n    <p v-if=\"msg.text\" class=\"text-sm whitespace-pre-wrap break-all \">\r\n      {{ msg.text }}\r\n    </p>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n<!-- Image message -->\r\n<img\r\n  v-if=\"msg.image\"\r\n  :src=\"msg.image\"\r\n  class=\"w-48 max-h-64 object-cover rounded-xl shadow-md cursor-pointer hover:opacity-90 transition\"\r\n  @click=\"openMediaPreview(msg.image)\"/>\r\n\r\n<!-- Video message -->\r\n<video\r\n  v-if=\"msg.video\"\r\n  :src=\"msg.video\"\r\n  class=\"w-48 max-h-64 object-cover rounded-xl shadow-md cursor-pointer hover:opacity-90 transition gap-1 \"\r\n  controls\r\n  @click=\"openMediaPreview(msg.video)\"/>\r\n\r\n<!-- Text Message -->\r\n<div\r\n  v-if=\"!msg.audio && !msg.file && !msg.image && !msg.video\"\r\n  class=\"px-4 py-2 rounded-2xl text-sm whitespace-pre-wrap break-all \"\r\n  :class=\"msg.from === 'me' ? 'bg-blue-500 text-white' : 'bg-green-500 text-white'\">\r\n  {{ msg.text }}\r\n</div>\r\n\r\n        \r\n    \r\n<!-- Media Preview Modal -->\r\n<div\r\nv-if=\"mediaPreview\"\r\nclass=\"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50\">\r\n<div class=\"relative\">\r\n<component\r\n:is=\"previewType === 'video' ? 'video' : 'img'\" \r\n:src=\"mediaPreview\"\r\nclass=\"max-w-[90vw] max-h-[85vh] rounded-lg shadow-xl\"\r\nv-bind=\"previewType === 'video' ? { controls: true } : {}\"/>\r\n<button\r\n@click=\"mediaPreview = null\"\r\nclass=\"absolute top-2 right-2 bg-black bg-opacity-50 p-2 rounded-full text-white hover:bg-opacity-70\"\r\ntitle=\"Close\">\r\n<Icon icon=\"ic:round-close\" class=\"w-6 h-6\" />\r\n</button>\r\n</div>\r\n</div>\r\n\r\n\r\n\r\n<!-- Delete Button (Visible on Hover) -->\r\n<button\r\n  class=\"absolute top-1 right-1 text-white text-xs bg-black bg-opacity-50 p-1 rounded-full hidden group-hover:block\"\r\n  @click=\"deleteMessage(index)\"\r\n  title=\"Delete\">\r\n</button>\r\n\r\n<!-- Forward Button -->\r\n<button\r\n  class=\"absolute bottom-1 right-8 text-xs text-white bg-blue-500 hover:bg-blue-600 rounded-full p-1 hidden group-hover:block\"\r\n  @click=\"forwardMessage(msg)\"\r\n  title=\"Forward\">\r\n  \r\n</button>\r\n\r\n<!-- Forward Modal -->\r\n<div v-if=\"forwardingMessage\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n<div class=\"bg-white rounded-xl p-4 w-80 shadow-lg\">\r\n<h2 class=\"text-lg font-semibold mb-3\">Forward to:</h2>\r\n<ul class=\"space-y-2\">\r\n<li\r\nv-for=\"friend in friends\"\r\n:key=\"friend.id\"\r\nclass=\"cursor-pointer hover:bg-gray-100 px-3 py-2 rounded\"\r\n @click=\"sendForwardTo(friend)\">\r\n{{ friend.name }}\r\n</li>\r\n</ul><button class=\"mt-4 text-sm text-red-500\" @click=\"forwardingMessage = null\">Cancel</button> \r\n</div>\r\n</div>\r\n\r\n\r\n<!--Time Stamp-->\r\n<p class=\"text-[11px] text-right opacity-70 mt-1\">{{ msg.time }}</p>\r\n</div>\r\n</div>\r\n</div>\r\n\r\n\r\n\r\n<!-- Input Area -->\r\n<div class=\" px-2 py-3 bg-white flex items-center gap-2\">\r\n<!-- Outer rounded box containing textarea + icons -->\r\n<div class=\"flex items-center flex-1 bg-white border border-gray-400 rounded-full px-3 py-2 shadow-sm gap-2\">\r\n    \r\n<!-- Mic -->\r\n<button\r\n@click=\"toggleRecording\"\r\nclass=\"text-gray-500 hover:text-red-500 transition\"\r\n:title=\"isRecording ? 'Stop recording' : 'Start recording'\">\r\n<Icon :icon=\"isRecording ? 'mdi:stop-circle-outline' : 'material-symbols:mic'\" class=\"w-5 h-5\" />\r\n</button>\r\n\r\n<!-- Textarea -->\r\n<textarea\r\n  v-model=\"newMessage\"\r\n  placeholder=\"Write something...\"\r\n  class=\"flex-1 bg-transparent text-sm text-black resize-none overflow-y-auto leading-snug align-top max-h-40 outline-none\"\r\n  rows=\"1\"\r\n  @input=\"autoResize\"\r\n  @keydown.enter.prevent=\"sendMessage\">\r\n  </textarea>\r\n\r\n    <!-- Photo/Video -->\r\n    <label class=\"cursor-pointer\">\r\n    <Icon icon=\"tabler:photo\" class=\"w-5 h-5 text-gray-500 hover:text-green-500\" />\r\n    <input type=\"file\" accept=\"image/*,video/*\" multiple hidden @change=\"handleMediaUpload\" />\r\n    </label>\r\n\r\n    <!-- Emoji -->\r\n    <button @click=\"toggleEmojiPicker\" title=\"Insert Emoji\">\r\n    <Icon icon=\"fa-regular:smile\" class=\"w-5 h-5 text-gray-500 hover:text-yellow-500\" />\r\n    </button>\r\n\r\n    <!-- File Attach -->\r\n    <button @click=\"triggerFileInput\" title=\"Attach File\" class=\"text-gray-500 hover:text-gray-800\">\r\n    <Icon icon=\"tdesign:attach\" class=\"w-5 h-5\" />\r\n    </button>\r\n    <input\r\n      ref=\"fileInput\"\r\n      type=\"file\"\r\n      accept=\".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.zip,.rar\"\r\n      hidden\r\n      @change=\"handleFileUpload\"/>\r\n\r\n  <!-- Send -->\r\n<button @click=\"sendMessage\" class=\"text-blue-500 hover:text-blue-700\">\r\n<Icon icon=\"ic:round-send\" class=\"w-5 h-5\" />\r\n</button>\r\n</div>\r\n</div>\r\n\r\n<!-- Emoji Picker Overlay -->\r\n<div\r\n  v-if=\"showEmojiPicker\"\r\n  class=\"fixed inset-0 flex items-center justify-center z-50\"\r\n  @click.self=\"showEmojiPicker = false\">\r\n  <div class=\"bg-white p-3 rounded-xl shadow-lg border w-80 max-h-[80vh] overflow-y-auto\">\r\n  <EmojiPicker @select=\"addEmoji\" />\r\n  </div>\r\n\r\n\r\n\r\n\r\n\r\n<!-- Floating Voice Waveform Bar -->\r\n<div\r\nv-if=\"isRecording\"\r\nclass=\"fixed bottom-24 left-1/2 -translate-x-1/2 z-50   \r\nbg-blue-600 rounded-full px-6 py-2 shadow-lg\r\nflex items-center justify-between gap-4 h-12 w-[360px] max-w-[90vw]\">\r\n\r\n         \r\n<!-- Animated Bars -->\r\n<div class=\"flex items-end gap-[2px] flex-1\">\r\n<div\r\nv-for=\"(bar, i) in waveformData\"\r\n:key=\"i\"\r\n:style=\"{ height: `${bar}px` }\"\r\nclass=\"w-[2px] bg-white rounded-sm transition-all duration-75 \"/>\r\n  </div>\r\n\r\n<!-- Timer Floating -->\r\n<div class=\"flex flex-col min-w-[60px]\">\r\n<span class=\"text-xs font-mono\">{{ recordingTimerDisplay }}</span>\r\n</div>\r\n</div>\r\n\r\n</div>\r\n<slot>\r\n</slot>\r\n</div>\r\n</div>\r\n</div>\r\n\r\n</template>\r\n\r\n<script setup>\r\nimport {  computed } from 'vue'\r\nimport { ref, nextTick } from 'vue'\r\nimport { Icon } from '@iconify/vue'\r\nimport EmojiPicker from 'vue3-emoji-picker'\r\nimport 'vue3-emoji-picker/css'\r\n\r\n\r\nconst props = defineProps({\r\n  currentUser: Object,\r\n  friends: Array,\r\n});\r\n\r\n\r\n\r\nconst searchQuery = ref('');\r\nconst chatStarted = ref(false);\r\nconst selectedUser = ref(null);\r\n\r\nconst filteredFriends = computed(() => {\r\n  return props.friends.filter(friend =>\r\n    friend.name.toLowerCase().includes(searchQuery.value.toLowerCase())\r\n  );\r\n});\r\n\r\nfunction selectFriend(friend) {\r\n  selectedUser.value = friend;\r\n  chatStarted.value = true;\r\n}\r\n\r\n\r\n\r\n\r\nimport sinayun from '@/assets/jeny3.jpg'\r\nimport story1 from '@/assets/story1.jpg'\r\nimport story2 from '@/assets/story2.jpg'\r\nimport story3 from '@/assets/story3.jpg'\r\nimport story4 from '@/assets/story4.jpg'\r\nimport story5 from '@/assets/story5.jpg'\r\n\r\n\r\n// States\r\nconst newMessage = ref('')\r\nconst showEmojiPicker = ref(false)\r\nconst messages = ref([])\r\n\r\n\r\nconst currentUser = ref({\r\n  name: 'sinayun_xyn',\r\n  role: 'Software Engineering',\r\n  avatar: sinayun\r\n})\r\n\r\n\r\n\r\n\r\n// Friend List\r\nconst friends = [\r\n  { id: 1, name: 'nita_lovekhmer', time: '01:12 PM', avatar: story1 },\r\n  { id: 2, name: 'áž“áž¶ážšáž¸_lovekhmer', time: '06:16 AM', avatar: story2 },\r\n  { id: 3, name: 'ycn_lovekhm', time: '01:12 PM', avatar: story3 },\r\n  { id: 4, name: 'Konsreypov', time: '1:12 PM', avatar: story4 },\r\n  { id: 5, name: 'Kon_Khmer', time: '1:12 PM', avatar: story5 }\r\n\r\n]\r\n\r\n\r\n// Send message\r\nfunction sendMessage() {\r\n  if (newMessage.value.trim()) {\r\n    const now = new Date()\r\n    const time = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n    messages.value.push({\r\n      text: newMessage.value.trim(),\r\n      from: 'me',\r\n      user: currentUser.value.name,\r\n      avatar: currentUser.value.avatar,\r\n      time,\r\n      date: getFormattedDate(now)\r\n    })\r\n\r\n    newMessage.value = ''\r\n    scrollToBottomSmart()\r\n\r\n    // Remove bot reply completely\r\n  }\r\n}\r\n\r\n// Emoji picker\r\nfunction toggleEmojiPicker() {\r\n  showEmojiPicker.value = !showEmojiPicker.value\r\n}\r\n\r\nfunction addEmoji(emoji) {\r\n  newMessage.value += emoji.i\r\n}\r\n\r\n// Format Date\r\nfunction getFormattedDate(date) {\r\n  return date.toLocaleDateString('en-GB') // Change format as needed\r\n}\r\n\r\n// Scroll to bottom smoothly\r\nfunction scrollToBottomSmart() {\r\n  nextTick(() => {\r\n    const chatContainer = document.querySelector('.flex-1.overflow-y-auto')\r\n    if (chatContainer) {\r\n      chatContainer.scrollTop = chatContainer.scrollHeight\r\n    }\r\n  })\r\n}\r\n\r\n\r\n\r\n// File handlers (optional)\r\nfunction handleMediaUpload(e) {\r\n  const files = Array.from(e.target.files)\r\n  if (!files.length) return\r\n\r\n  files.forEach(file => {\r\n    const reader = new FileReader()\r\n    reader.onload = () => {\r\n      const now = new Date()\r\n      const isVideo = file.type.startsWith('video')\r\n\r\n      messages.value.push({\r\n        from: 'me',\r\n        avatar: currentUser.value.avatar,\r\n        time: now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),\r\n        [isVideo ? 'video' : 'image']: reader.result\r\n      })\r\n\r\n      scrollToBottomSmart()\r\n    }\r\n    reader.readAsDataURL(file)\r\n  })\r\n}\r\n\r\n\r\n\r\n\r\nconst mediaPreview = ref(null)\r\n\r\nfunction openMediaPreview(src) {\r\n  mediaPreview.value = src\r\n}\r\n\r\nfunction deleteMessage(index) {\r\n  messages.value.splice(index, 1)\r\n}\r\n\r\n\r\n//Paper Clip\r\nconst fileInput = ref(null)\r\n\r\nfunction triggerFileInput() {\r\n  fileInput.value?.click()\r\n}\r\n\r\nfunction handleFileUpload(e) {\r\n  const file = e.target.files[0]\r\n  if (!file) return\r\n\r\n  const now = new Date()\r\n  const url = URL.createObjectURL(file)\r\n\r\n  messages.value.push({\r\n    from: 'me',\r\n    avatar: currentUser.value.avatar,\r\n    file: {\r\n      name: file.name,\r\n      type: file.type,\r\n      url\r\n    },\r\n    time: now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n  })\r\n}\r\n\r\n\r\n//Mic \r\nconst recordingTimer = ref(0) // Timer in seconds\r\n\r\nconst recordingTimerDisplay = computed(() => {\r\n  const min = String(Math.floor(recordingTimer.value / 60)).padStart(2, '0')\r\n  const sec = String(recordingTimer.value % 60).padStart(2, '0')\r\n  return `${min}:${sec}`\r\n})\r\n\r\n\r\n\r\n\r\n\r\nconst isRecording = ref(false)\r\nlet mediaRecorder = null\r\nlet audioChunks = []\r\nlet timerInterval = null\r\nlet audioContext = null\r\nlet analyser = null\r\nlet animationId = null\r\n\r\n\r\n\r\nfunction toggleRecording() {\r\n  if (isRecording.value) {\r\n    stopRecording()\r\n  } else {\r\n    startRecording()\r\n  }\r\n}\r\nfunction startRecording() {\r\n  navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {\r\n    mediaRecorder = new MediaRecorder(stream)\r\n    audioChunks = []\r\n\r\n    mediaRecorder.ondataavailable = (e) => audioChunks.push(e.data)\r\n\r\n    mediaRecorder.onstop = () => {\r\n      clearInterval(timerInterval)\r\n      cleanupAudioVisualizer()\r\n      if (!audioChunks.length) return\r\n\r\n      const blob = new Blob(audioChunks, { type: 'audio/webm' })\r\n      const url = URL.createObjectURL(blob)\r\n\r\n      messages.value.push({\r\n        from: 'me',\r\n        avatar: currentUser.value.avatar,\r\n        audio: url,\r\n        time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n      })\r\n    }\r\n\r\n    mediaRecorder.start()\r\n    isRecording.value = true\r\n    recordingTimer.value = 0\r\n\r\n    // âœ… This line fixes the warning and activates the waveform\r\n    startWaveformVisualizer(stream)\r\n\r\n    timerInterval = setInterval(() => {\r\n      recordingTimer.value++\r\n    }, 1000)\r\n  })\r\n}\r\n\r\n\r\n \r\nfunction stopRecording() {\r\n  if (mediaRecorder && isRecording.value) {\r\n    mediaRecorder.stop()\r\n    isRecording.value = false\r\n    clearInterval(timerInterval)\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//Touch Audio\r\nconst touchStartX = ref(0)\r\nconst touchEndX = ref(0)\r\n\r\nfunction onTouchStart(e) {\r\n  touchStartX.value = e.touches[0].clientX\r\n}\r\n\r\nfunction onTouchMove(e) {\r\n  touchEndX.value = e.touches[0].clientX\r\n}\r\n\r\nfunction onTouchEnd(index) {\r\n  const distance = touchStartX.value - touchEndX.value\r\n  if (distance > 80) {\r\n    // Swipe left = delete audio\r\n    messages.value.splice(index, 1)\r\n  }\r\n}\r\n\r\n\r\n//Wave voice\r\nconst waveformData = ref(new Array(80).fill(4)) // 80 bars at 4px height\r\n\r\n// ðŸŽ¤ Start mic visualizer\r\nfunction startWaveformVisualizer(stream) {\r\n  audioContext = new (window.AudioContext || window.webkitAudioContext)()\r\n  const source = audioContext.createMediaStreamSource(stream)\r\n  analyser = audioContext.createAnalyser()\r\n  analyser.fftSize = 64\r\n  source.connect(analyser)\r\n\r\n  const bufferLength = analyser.frequencyBinCount\r\n  const dataArray = new Uint8Array(bufferLength)\r\n\r\n  const render = () => {\r\n    analyser.getByteFrequencyData(dataArray)\r\n\r\n    waveformData.value = dataArray\r\n      .slice(0, waveformData.value.length)\r\n      .map(v => Math.max(4, (v / 255) * 28)) // scale height smoothly\r\n\r\n    animationId = requestAnimationFrame(render)\r\n  }\r\n\r\n  render()\r\n}\r\n\r\n// ðŸ§¼ Stop mic visualizer\r\nfunction cleanupAudioVisualizer() {\r\n  cancelAnimationFrame(animationId)\r\n  if (audioContext) {\r\n    audioContext.close()\r\n    audioContext = null\r\n  }\r\n  waveformData.value = new Array(80).fill(4)\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//Swipe Audio\r\nfunction swipeTranslateX() {\r\n  const distance = touchStartX.value - touchEndX.value\r\n  return distance > 0 ? `translateX(-${Math.min(distance, 100)}px)` : ''\r\n}\r\n\r\n\r\n// Forward  massage\r\nconst forwardingMessage = ref(null)\r\n\r\nfunction forwardMessage(msg) {\r\n  forwardingMessage.value = msg\r\n}\r\n\r\nfunction sendForwardTo(friend) {\r\n  const now = new Date()\r\n  const forwarded = { ...forwardingMessage.value, time: now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) }\r\n\r\n  // simulate message going to another user\r\n  messages.value.push({\r\n    ...forwarded,\r\n    from: 'me',\r\n    forwardedTo: friend.name\r\n  })\r\n\r\n  forwardingMessage.value = null\r\n}\r\n\r\n// Auto row\r\n\r\nconst autoResize = (e) => {\r\n  const el = e.target\r\n  el.style.height = 'auto'\r\n  el.style.height = el.scrollHeight + 'px'\r\n}\r\n\r\n\r\n//\r\n\r\n</script>\r\n\r\n\r\n<style scoped>\r\n/* Optional fallback to make modal clickable */\r\n.z-50 {\r\n  z-index: 9999;\r\n\r\n\r\n\r\n\r\n}\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}