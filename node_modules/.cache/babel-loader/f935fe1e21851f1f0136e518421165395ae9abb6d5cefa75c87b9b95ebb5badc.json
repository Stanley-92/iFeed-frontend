{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { Icon } from '@iconify/vue';\nimport story1 from '@/assets/Khmer.jpg';\nimport story2 from '@/assets/jena8.jpg';\nimport story3 from '@/assets/sinayun_xyn.jpg';\nimport GoogleSignInButton from '@/components/GoogleSignInButton.vue';\nimport { signInWithEmailAndPassword, signOut } from 'firebase/auth';\nimport { auth } from '../firebase';\nexport default {\n  name: 'Login',\n  components: {\n    Icon,\n    GoogleSignInButton\n  },\n  data() {\n    return {\n      email: '',\n      password: '',\n      loading: false,\n      showPassword: false,\n      stories: [{\n        img: story2,\n        rotate: '-14deg',\n        right: '70px',\n        z: 2\n      }, {\n        img: story1,\n        rotate: '12deg',\n        left: '300px',\n        z: 1\n      }, {\n        img: story3,\n        rotate: '-2deg',\n        left: '168px',\n        z: 1\n      }]\n    };\n  },\n  // THIS clears password on refresh / revisit login page\n  mounted() {\n    this.password = '';\n  },\n  methods: {\n    async login() {\n      if (this.loading) return;\n      if (!this.email || !this.password) {\n        alert('Please enter both email and password.');\n        return;\n      }\n      this.loading = true;\n      try {\n        const {\n          user\n        } = await signInWithEmailAndPassword(auth, this.email, this.password);\n        if (!user.emailVerified) {\n          alert('Please verify your email before logging in.');\n          await signOut(auth); // This is why it kicks you out\n          return;\n        }\n        this.password = '';\n        this.$router.push('/feed');\n      } catch (e) {\n        // Check if account exists but has no password (Google users)\n        if (e.code === 'auth/invalid-credential' || e.code === 'auth/wrong-password') {\n          alert(\"Invalid password. If you originally joined with Google, please use the 'Connect with Google' button or use 'Forgot Password' to create a manual login password.\");\n        } else {\n          alert(this.getErrorMessage(e.code));\n        }\n      } finally {\n        this.loading = false;\n      }\n    },\n    // Inside your Sidebar/Settings component logout logic\n    async goLogin() {\n      await signOut(auth);\n      localStorage.clear(); // Important: Wipes Gmail avatar/name from memory\n      this.$router.push('/').then(() => {\n        window.location.reload(); // Ensures all Vue data is reset to empty strings\n      });\n    },\n    getErrorMessage(code) {\n      const messages = {\n        'auth/user-not-found': 'Account not found.',\n        'auth/wrong-password': 'Incorrect password.',\n        'auth/invalid-credential': 'Login failed. If you signed up with Google, please use the Google button.',\n        // Added this\n        'auth/invalid-email': 'Invalid email address.'\n        // ...\n      };\n      return messages[code] || `Error: ${code}`; // Show the code so you can debug\n    }\n  }\n};","map":{"version":3,"names":["Icon","story1","story2","story3","GoogleSignInButton","signInWithEmailAndPassword","signOut","auth","name","components","data","email","password","loading","showPassword","stories","img","rotate","right","z","left","mounted","methods","login","alert","user","emailVerified","$router","push","e","code","getErrorMessage","goLogin","localStorage","clear","then","window","location","reload","messages"],"sources":["D:\\login-feed\\src\\components\\Login.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-gray flex items-center justify-center\">\r\n  <div class=\"flex w-full max-w-6xl items-center justify-between px-8 gap-10\">\r\n\r\n      <!-- LEFT TEXT -->\r\n\r\n\r\n<div class=\"flex min-h-[100dvh] mt-8  \">\r\n<aside >\r\n<div class=\" w-65 hidden md:block max-w-full\">\r\n<button class=\"flex-1 items-center pl-3 cursor-pointer \">\r\n<Icon icon=\"tdesign:chat-bubble\" \r\nclass=\"w-14 h-14 text-white transition-colors\r\n bg-green-500 border-4 border-green-500 rounded-xl\r\n  duration-200 hover:text-gray-600 mb-10\" \r\n @click=\"goToMainfeed\"/>\r\n</button>\r\n\r\n\r\n<div class=\"flex items-center gap-4 \">\r\n<p class=\"text-gray-600 leading-relaxed\">\r\n          Connect with the people in your life and the world. \r\n          Secure and safe sharing your activity.\r\n        </p>\r\n</div>\r\n\r\n   <!-- ACTION MENU -->\r\n    <!-----  <div class=\"flex flex-col gap-6 text-black\">\r\n          <div class=\"flex items-center gap-3\">\r\n          </div>\r\n      \r\n          <div class=\"flex items-center gap-3\">\r\n           <Icon icon=\"uil:comment\" class=\"w-10 h-10\"/>\r\n            <span class=\"text-xl font-semibold\">Share</span>\r\n          </div>\r\n        </div>\r\n--->\r\n      </div>\r\n\r\n      <!-- ACTION + STORY STACK -->\r\n      <div class=\"relative items-center mt-10 p-2  \">\r\n    <!-- CENTER STORY STACK -->\r\n      <div class=\"relative   items-center w-[360px] h-[320px] mt-10 px-4 mr-80  p-2\">\r\n        <img\r\n          v-for=\"(story, i) in stories\"\r\n          :key=\"i\"\r\n          :src=\"story.img\"\r\n          class=\"story-card\"\r\n          :style=\"{\r\n            transform: `rotate(${story.rotate})`,\r\n            left: story.left,\r\n            zIndex: story.z\r\n          }\"/>\r\n        </div>\r\n      \r\n  \r\n</div>\r\n\r\n</aside>\r\n\r\n</div>\r\n\r\n\r\n\r\n        \r\n \r\n\r\n\r\n<!-- LOGIN FORM -->\r\n<div class=\" border-2   p-8 rounded-xl shadow-md w-full max-w-sm  mb-50\">\r\n       <!-- Email -->\r\n<input\r\n  type=\"text\"\r\n  placeholder=\"Email or Phone number\"\r\n  class=\"w-full mb-4 px-4 py-2 border-2 rounded outline-none focus:ring-2 focus:ring-blue-500\"\r\n  v-model=\"email\"\r\n  autocomplete=\"off\"\r\n  name=\"login_email\"\r\n/>\r\n\r\n<!-- Password -->\r\n<input\r\n  type=\"password\"\r\n  placeholder=\"Password\"\r\n  class=\"w-full mb-4 px-4 py-2 border-2 rounded outline-none focus:ring-2 focus:ring-blue-500\"\r\n  v-model=\"password\"\r\n  autocomplete=\"new-password\"\r\n  name=\"login_password\"\r\n  readonly\r\n  @focus=\"$event.target.removeAttribute('readonly')\"/>\r\n\r\n        <button\r\n          class=\"w-full bg-blue-600 text-white \r\n          font-semibold py-2 rounded hover:bg-blue-700 mb-2\"\r\n          @click=\"login\">\r\n          Login\r\n        </button>\r\n\r\n        <router-link\r\n          to=\"/forgot\"\r\n          class=\"text-sm text-center  text-gray-600 mb-4 block\">\r\n          Forgot your password ?\r\n        </router-link>\r\n\r\n        <hr class=\"mb-4\" />\r\n\r\n        <router-link to=\"/create\" class=\"block\">\r\n          <button\r\n            class=\"bg-blue-500 text-white  rounded-xl w-full\r\n             py-2 rounded text-sm font-semibold hover:bg-gray-400\">\r\n            Create your account\r\n          </button>\r\n        </router-link>\r\n        <!-- New Google Sign-In Button -->\r\n<div class=\"flex justify-center mb-4 mt-4\">\r\n<GoogleSignInButton redirectAfter=\"ProfileUser\" />\r\n</div>\r\n\r\n      </div>\r\n\r\n    </div>\r\n   \r\n  </div>\r\n\r\n\r\n  \r\n</template>\r\n\r\n<script>\r\nimport { Icon } from '@iconify/vue';\r\nimport story1 from '@/assets/Khmer.jpg'\r\nimport story2 from '@/assets/jena8.jpg'\r\nimport story3 from '@/assets/sinayun_xyn.jpg'\r\nimport GoogleSignInButton from '@/components/GoogleSignInButton.vue';\r\nimport { signInWithEmailAndPassword, signOut } from 'firebase/auth'\r\n\r\nimport { auth } from '../firebase'\r\n\r\n\r\n\r\n\r\nexport default {\r\n  name: 'Login',\r\n   components:{\r\n     Icon ,\r\n   GoogleSignInButton,\r\n\r\n   },\r\n\r\n  data() {\r\n    return {\r\n      email: '',\r\n      password: '',\r\n      loading: false,\r\n      showPassword: false,\r\n\r\n\r\n      stories: [\r\n        { img: story2, rotate: '-14deg', right: '70px', z: 2 },\r\n        { img: story1, rotate: '12deg', left: '300px', z: 1},\r\n      \r\n        { img: story3, rotate: '-2deg', left: '168px', z: 1 }\r\n      ]\r\n    }\r\n  },\r\n\r\n \r\n  // THIS clears password on refresh / revisit login page\r\n  mounted() {\r\n    this.password = '';\r\n  },\r\n\r\n\r\n \r\n  methods: {\r\n async login() {\r\n  if (this.loading) return;\r\n  if (!this.email || !this.password) {\r\n    alert('Please enter both email and password.');\r\n    return;\r\n  }\r\n\r\n  this.loading = true;\r\n\r\n  try {\r\n    const { user } = await signInWithEmailAndPassword(auth, this.email, this.password);\r\n\r\n   if (!user.emailVerified) {\r\n  alert('Please verify your email before logging in.');\r\n  await signOut(auth); // This is why it kicks you out\r\n  return;\r\n}\r\n\r\n    this.password = '';\r\n    this.$router.push('/feed');\r\n\r\n  } catch (e) {\r\n    // Check if account exists but has no password (Google users)\r\n    if (e.code === 'auth/invalid-credential' || e.code === 'auth/wrong-password') {\r\n      alert(\"Invalid password. If you originally joined with Google, please use the 'Connect with Google' button or use 'Forgot Password' to create a manual login password.\");\r\n    } else {\r\n      alert(this.getErrorMessage(e.code));\r\n    }\r\n  } finally {\r\n    this.loading = false;\r\n  }\r\n},\r\n\r\n\r\n\r\n// Inside your Sidebar/Settings component logout logic\r\nasync goLogin() {\r\n  await signOut(auth);\r\n  localStorage.clear(); // Important: Wipes Gmail avatar/name from memory\r\n  this.$router.push('/').then(() => {\r\n    window.location.reload(); // Ensures all Vue data is reset to empty strings\r\n  });\r\n},\r\n\r\n   getErrorMessage(code) {\r\n  const messages = {\r\n    'auth/user-not-found': 'Account not found.',\r\n    'auth/wrong-password': 'Incorrect password.',\r\n    'auth/invalid-credential': 'Login failed. If you signed up with Google, please use the Google button.', // Added this\r\n    'auth/invalid-email': 'Invalid email address.',\r\n    // ...\r\n  }\r\n  return messages[code] || `Error: ${code}`; // Show the code so you can debug\r\n}\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n\r\n\r\n\r\n<style scoped>\r\n\r\n.input {\r\n  @apply w-full mb-3 px-3 py-2 border rounded text-sm outline-none focus:ring-2 focus:ring-blue-500;\r\n}\r\n\r\n.btn-primary {\r\n  @apply w-full bg-blue-600 text-white py-2 rounded font-semibold;\r\n}\r\n\r\n.btn-success {\r\n  @apply w-full bg-green-600 text-white py-2 rounded text-sm font-semibold;\r\n}\r\n.story-card:hover {\r\n  transform: translateY(-8px) scale(1.05);\r\n  z-index: 50;\r\n}\r\n.story-card {\r\n  @apply absolute top-0\r\n  w-[148px] h-[240px]\r\n  rounded-2xl\r\n  object-cover\r\n  shadow-[0_20px_40px_rgba(0,0,0,0.78)]\r\n  transition-transform duration-300 ease-out;\r\n}\r\n\r\n/* Hover animation */\r\n.story-card:hover {\r\n  transform: translateY(-8px) scale(1.05) rotate(var(--tw-rotate));\r\n}\r\n\r\n.story-card:hover {\r\n  transform: translateY(-8px) scale(1.05);\r\n}\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}